
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>üîß Robot Setup &#8212; Introduction to Robotic Systems</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css?v=4c969af8" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="../_static/tabs.js?v=3ee01567"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Appendix/RobotSetup';</script>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="üîß Master Setup" href="MasterSetup.html" />
    <link rel="prev" title="üöÄ Final Project" href="../Labs/FinalProject.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/ece387.png" class="logo__image only-light" alt="Introduction to Robotic Systems - Home"/>
    <script>document.write(`<img src="../_static/ece387.png" class="logo__image only-dark" alt="Introduction to Robotic Systems - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    ECE 387 Introduction to Robotic Systems
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Course Info</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../syllabus.html">üìå ECE387 Syllabus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../schedule.html">üìÜ Course Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../AI_policy.html">ü§ñ AI Usage Policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">üôã FAQ</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Labs</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Labs/Lab1_Linux.html">üî¨ Lab1: Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Labs/Lab2_ROS.html">üî¨ Lab2: ROS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Labs/Lab3_Python.html">üî¨ Lab3: Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Labs/Lab4_Gamepad.html">üî¨ Lab4: Gamepad</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Labs/Lab5_TurtleBot.html">üî¨ Lab5: Driving the Robot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Labs/Lab6_IMU.html">üî¨ Lab6: IMU-Based Navigation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Labs/Lab7_TF.html">üî¨ Lab7: Transformation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Labs/Lab8_LIDAR.html">üî¨ Lab 8: LiDAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Labs/Lab9_SLAM.html">üî¨ Lab9: SLAM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Labs/Lab10_CV.html">üî¨ Lab10: CV</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Labs/Lab11_AprilTag.html">üî¨ Lab11: AprilTag</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Labs/FinalProject.html">üöÄ Final Project</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Supplementary</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://stanbaek.github.io/workshops/PythonBasic.html">Python PythonBasic</a></li>
<li class="toctree-l1"><a class="reference external" href="https://stanbaek.github.io/workshops/PythonIntermediate.html">Python Containers</a></li>
<li class="toctree-l1"><a class="reference external" href="https://stanbaek.github.io/workshops/NumPy.html">NumPy</a></li>
<li class="toctree-l1"><a class="reference external" href="https://stanbaek.github.io/NoPointer.html">No Pointers in Python?</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">üîß Robot Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="MasterSetup.html">üîß Master Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="GitSetup.html">üîß Git Repo Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="GamepadSetup.html">üîß Gamepad Setup</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/stanbaek/ece387" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/stanbaek/ece387/issues/new?title=Issue%20on%20page%20%2FAppendix/RobotSetup.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Appendix/RobotSetup.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>üîß Robot Setup</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#turtlebot3">TurtleBot3</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hardware-assembly">Hardware Assembly</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#raspberry-pi">Raspberry Pi</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#camera">Camera</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ubuntu-installation">Ubuntu Installation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-ubuntu-and-flash-microsd-card">Download Ubuntu and flash MicroSD card</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#configuring-ubuntu">Configuring Ubuntu</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#login-and-changing-password">Login and changing password</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-username">Adding username</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#change-hostname">Change hostname</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#set-up-wi-fi-optional">Set up Wi-Fi (Optional)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#static-ip-address-optional">Static IP Address (Optional)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#disable-automatic-updates">Disable Automatic Updates</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#verify-changes">Verify changes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#update-and-upgrade">Update and Upgrade</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#install-ubuntu-desktop-optional">Install Ubuntu Desktop (optional)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#install-rtl8723bu-driver-ubuntu-22-04">Install RTL8723BU driver (Ubuntu 22.04)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dual-wi-fi-setup-client-access-point">Dual Wi-Fi Setup (Client + Access Point)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#goal-final-architecture">GOAL (Final Architecture)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#verify-interfaces">Verify Interfaces</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#configure-wi-fi-client-internet-wlan1">Configure Wi-Fi Client (Internet) ‚Äî <code class="docutils literal notranslate"><span class="pre">wlan1</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#configure-static-ip-for-access-point-wlan0">Configure Static IP for Access Point ‚Äî <code class="docutils literal notranslate"><span class="pre">wlan0</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#configure-dhcp-for-ap-clients-dnsmasq">Configure DHCP for AP Clients (dnsmasq)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-controls-the-ap-instead">What controls the AP instead</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hostapd-configuration-template">Hostapd Configuration Template</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#systemd-service-for-automatic-ssid-update">Systemd Service for Automatic SSID Update</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#disable-cloud-init-hostname-reset-important">Disable cloud-init Hostname Reset (IMPORTANT)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#final-verification">Final Verification</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ros2-humble">ROS2 Humble</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#installation">Installation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#configuring-ros2-environment">Configuring ROS2 Environment</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#install-and-build-ros2-packages">Install and Build ROS2 Packages</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#usb-port-setting-for-opencr">USB Port Setting for OpenCR</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lds-configuration">LDS Configuration</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#install-software-for-ece-387">Install software for ECE 387</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#camera-permissions">Camera Permissions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#updating-opencr-firmware">Updating OpenCR firmware</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setup-github-ssh-keys">Setup GitHub SSH Keys</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#optional-updates">Optional Updates</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#update-alternatives">Update Alternatives</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ece387-curriculum">ECE387 Curriculum</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#add-swap-space-optional">Add Swap Space (optional)</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="robot-setup">
<h1>üîß Robot Setup<a class="headerlink" href="#robot-setup" title="Link to this heading">#</a></h1>
<p>This guide will walk through the steps to install Ubuntu Server 22.04 LTS, ROS2 Humble, and all dependencies on a Raspberry Pi 4B. This Pi is then embedded within the Robotis TurtleBot3 Burger along with a USB camera. The robotics system, TurtleBot3, is utilized in the United States Air Force Academy‚Äôs Electrical and Computer Engineering department to teach undergraduate students robotics.</p>
<p>This guide is adapted from the <a class="reference external" href="https://emanual.robotis.com/docs/en/platform/turtlebot3/overview/#overview">TurtleBot3 e-Manual</a>.</p>
<ul class="simple">
<li><p>Created by Steve Beyer, 2022</p></li>
<li><p>Updated by Stan Baek, 2023</p></li>
</ul>
<hr class="docutils" />
<section id="turtlebot3">
<h2>TurtleBot3<a class="headerlink" href="#turtlebot3" title="Link to this heading">#</a></h2>
<p>Below is a list of recommended hardware and links. Other off-the-shelf components can replace the ones below.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.robotis.us/turtlebot-3/">TurtleBot3</a></p></li>
<li><p><a class="reference external" href="https://www.adesso.com/product/cybertrack-h4-1080p-hd-usb-webcam-with-built-in-microphone/">USB Camera</a> (Any USB Cam will work, this is the one we use)</p></li>
<li><p>128 GB High Speed MicroSD card</p></li>
<li><p>Monitor, mouse, and keyboard</p></li>
<li><p>If using an older version of the TurtleBot3 with a Jetson Nano or Raspberry Pi 3B+ you will need ot purchase a <a class="reference external" href="https://www.canakit.com/raspberry-pi-4-8gb.html">Raspberry Pi 4 Model B</a> (preferably with 8 GB of RAM))</p></li>
</ul>
<section id="hardware-assembly">
<h3>Hardware Assembly<a class="headerlink" href="#hardware-assembly" title="Link to this heading">#</a></h3>
<p>Follow the <a class="reference external" href="https://emanual.robotis.com/docs/en/platform/turtlebot3/hardware_setup/#hardware-assembly">Robotis e-Manual</a> for hardware assembly stopping after installing the Raspberry Pi.</p>
</section>
<section id="raspberry-pi">
<h3>Raspberry Pi<a class="headerlink" href="#raspberry-pi" title="Link to this heading">#</a></h3>
<p>A Raspberry Pi 4 B with 8 GB of RAM is used throughout this curriculum. Ensure heat sinks are propertly installed on the Pi such as these from <a class="reference external" href="https://www.canakit.com/raspberry-pi-4-heat-sinks.html">CanaKit</a>.</p>
<p>Also, a small fan can be installed to help with cooling. We used this 3D printed bracket to mount the fan.</p>
<a class="reference internal image-reference" href="../_images/fan.jpg"><img alt="../_images/fan.jpg" class="align-center" src="../_images/fan.jpg" style="width: 380px;" />
</a>
</section>
<section id="camera">
<h3>Camera<a class="headerlink" href="#camera" title="Link to this heading">#</a></h3>
<p>After installing the Raspberry pi level of the TurtleBot3 you need to install the USB Camera Mount prior to finishing the robot build. The mount used in this course can be found in the <a class="reference download internal" download="" href="../_downloads/3a3cd348ff4a2bc81ddea473f4ae906f/burger_usbcam_mount.stl"><span class="xref download myst">curriculum material</span></a> and is installed on two of the front standoffs on the TurtleBot3.</p>
<a class="reference internal image-reference" href="../_images/camera_mount.jpg"><img alt="../_images/camera_mount.jpg" class="align-center" src="../_images/camera_mount.jpg" style="width: 280px;" />
</a>
</section>
</section>
<section id="ubuntu-installation">
<h2>Ubuntu Installation<a class="headerlink" href="#ubuntu-installation" title="Link to this heading">#</a></h2>
<section id="download-ubuntu-and-flash-microsd-card">
<h3>Download Ubuntu and flash MicroSD card<a class="headerlink" href="#download-ubuntu-and-flash-microsd-card" title="Link to this heading">#</a></h3>
<p>There are multiple ways to download and install Ubuntu 22.04.5 to a MicroSD card, but the Raspberry Pi Imager is one of the easiest. Instructions for installing the imager on your operating system can be found on the <a class="reference external" href="https://www.raspberrypi.com/software/">Raspberry Pi OS software page</a>.</p>
<p>Once installed, start the imager and select ‚ÄúRaspberry Pi 4‚Äù.
<br></p>
<a class="reference internal image-reference" href="../_images/installer1.png"><img alt="../_images/installer1.png" class="align-center" src="../_images/installer1.png" style="width: 480px;" />
</a>
<br>
Scroll down the menu and select "Other general purpose OS".
<br>
<a class="reference internal image-reference" href="../_images/installer2.png"><img alt="../_images/installer2.png" class="align-center" src="../_images/installer2.png" style="width: 480px;" />
</a>
<br>
<p>Next, select ‚ÄúUbuntu‚Äù.
<br></p>
<a class="reference internal image-reference" href="../_images/installer3.png"><img alt="../_images/installer3.png" class="align-center" src="../_images/installer3.png" style="width: 480px;" />
</a>
<br>
Lastly, scroll and select the latest 64-bit version of "Ubuntu Server 22.04 LTS (64-bit)".
<br>
<a class="reference internal image-reference" href="../_images/installer4.png"><img alt="../_images/installer4.png" class="align-center" src="../_images/installer4.png" style="width: 480px;" />
</a>
<br>
<p>Now that you have the correct image selected, you need to choose the correct storage device that corresponds to the MicroSD card.</p>
<p>Once complete you should have an Ubuntu SD card! Ensure your Raspberry Pi is powered off, connected to a monitor, keyboard, and mouse, and insert the SD card.</p>
</section>
</section>
<section id="configuring-ubuntu">
<h2>Configuring Ubuntu<a class="headerlink" href="#configuring-ubuntu" title="Link to this heading">#</a></h2>
<section id="login-and-changing-password">
<h3>Login and changing password<a class="headerlink" href="#login-and-changing-password" title="Link to this heading">#</a></h3>
<p>Once Ubuntu boots up you will be prompted to enter the login and password. It may take a few minutes on first boot to configure the default username and password, so if login fails, try again after a few minutes.</p>
</section>
<section id="adding-username">
<h3>Adding username<a class="headerlink" href="#adding-username" title="Link to this heading">#</a></h3>
<p>We need to create a new user named <em>pi</em> for students.</p>
<ul>
<li><p>Create the <em>pi</em> user:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>adduser<span class="w"> </span>pi
</pre></div>
</div>
<p>Enter an easy-to-remember password when prompted, then press Enter through the remaining prompts until you return to the terminal.</p>
</li>
<li><p>Grant <em>sudo</em> previleges:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>adduser<span class="w"> </span>pi<span class="w"> </span>sudo
</pre></div>
</div>
</li>
<li><p>Switch to the new user</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">exit</span>
</pre></div>
</div>
<p>Then log in using the <em>pi</em> account credentials.</p>
</li>
<li><p>Once logged in as <em>pi</em>, your terminal prompt should show <code class="docutils literal notranslate"><span class="pre">pi&#64;ubuntu:</span></code>. Confirm your current directory by running:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">pwd</span>
</pre></div>
</div>
<p>This should display <code class="docutils literal notranslate"><span class="pre">/home/pi</span></code>.</p>
</li>
</ul>
</section>
<section id="change-hostname">
<h3>Change hostname<a class="headerlink" href="#change-hostname" title="Link to this heading">#</a></h3>
<p>If you have multiple robots on your network it is good to give each a unique hostname. We number each robot from 0-n and each robot has a corresponding hostname (e.g., robot0).</p>
<p>Change the hostname with the command line editor of your choice.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>hostnamectl<span class="w"> </span>set-hostname<span class="w"> </span>robot0
</pre></div>
</div>
<p>The new hostname will not take effect until reboot. Don‚Äôt reboot yet, though! We have a couple more things to accomplish before reboot.</p>
</section>
<section id="set-up-wi-fi-optional">
<h3>Set up Wi-Fi (Optional)<a class="headerlink" href="#set-up-wi-fi-optional" title="Link to this heading">#</a></h3>
<p>Until a desktop GUI is installed we have to work with the command line to set up the Wi-Fi. This is the most reliable method I have found and we will delete these changes once a GUI is installed.</p>
<ul>
<li><p>First, determine the name of your Wi-Fi network adapter by typing <code class="docutils literal notranslate"><span class="pre">ip</span> <span class="pre">link</span></code> (for the Raspberry Pi version of Ubuntu Server 20.04 LTS it is typically <strong><code class="docutils literal notranslate"><span class="pre">wlan0</span></code></strong>).</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pi@ubuntu:~$<span class="w"> </span>ip<span class="w"> </span>link
<span class="m">1</span>:<span class="w"> </span>lo:<span class="w"> </span>&lt;LOOPBACK,UP,LOWER_UP&gt;<span class="w"> </span>mtu<span class="w"> </span><span class="m">65536</span><span class="w"> </span>qdisc<span class="w"> </span>noqueue<span class="w"> </span>state<span class="w"> </span>UNKNOWN<span class="w"> </span>mode<span class="w"> </span>DEFAULT<span class="w"> </span>group<span class="w"> </span>default<span class="w"> </span>qlen<span class="w"> </span><span class="m">1000</span>
<span class="w">    </span>link/loopback<span class="w"> </span><span class="m">00</span>:00:00:00:00:00<span class="w"> </span>brd<span class="w"> </span><span class="m">00</span>:00:00:00:00:00
<span class="m">2</span>:<span class="w"> </span>eth0:<span class="w"> </span>&lt;NO-CARRIER,BROADCAST,MULTICAST,UP&gt;<span class="w"> </span>mtu<span class="w"> </span><span class="m">1500</span><span class="w"> </span>qdisc<span class="w"> </span>mq<span class="w"> </span>state<span class="w"> </span>DOWN<span class="w"> </span>mode<span class="w"> </span>DEFAULT<span class="w"> </span>group<span class="w"> </span>default<span class="w"> </span>qlen<span class="w"> </span><span class="m">1000</span>
<span class="w">    </span>link/ether<span class="w"> </span>e4:5f:01:15:5b:30<span class="w"> </span>brd<span class="w"> </span>ff:ff:ff:ff:ff:ff
<span class="m">3</span>:<span class="w"> </span>wlan0:<span class="w"> </span>&lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt;<span class="w"> </span>mtu<span class="w"> </span><span class="m">1500</span><span class="w"> </span>qdisc<span class="w"> </span>fq_codel<span class="w"> </span>state<span class="w"> </span>UP<span class="w"> </span>mode<span class="w"> </span>DORMANT<span class="w"> </span>group<span class="w"> </span>default<span class="w"> </span>qlen<span class="w"> </span><span class="m">1000</span>
<span class="w">    </span>link/ether<span class="w"> </span>e4:5f:01:15:5b:31<span class="w"> </span>brd<span class="w"> </span>ff:ff:ff:ff:ff:ff
</pre></div>
</div>
</li>
<li><p>Open the <code class="docutils literal notranslate"><span class="pre">/etc/netplan/50-cloud-init.yaml</span></code> file in your favorite browser:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>nano<span class="w"> </span>/etc/netplan/50-cloud-init.yaml
</pre></div>
</div>
</li>
<li><p>Edit the file so it looks like the below (use spaces and not tabs) replacing <strong>wlan0</strong> with your wireless network interface and using your SSID and password:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># This file is generated from information provided by the datasource.  Changes</span>
<span class="c1"># to it will not persist across an instance reboot.  To disable cloud-init&#39;s  </span>
<span class="c1"># network configuration capabilities, write a file</span>
<span class="c1"># /etc/cloud/cloud.cfg.d/99-disable-network-config.cfg with the following:    </span>
<span class="c1"># network: {config: disabled}</span>
<span class="n">network</span><span class="p">:</span>
    <span class="n">ethernets</span><span class="p">:</span>
        <span class="n">eth0</span><span class="p">:</span>
            <span class="n">dhcp4</span><span class="p">:</span> <span class="n">true</span>
            <span class="n">optional</span><span class="p">:</span> <span class="n">true</span>
    <span class="n">version</span><span class="p">:</span> <span class="mi">2</span>
    <span class="n">wifis</span><span class="p">:</span>
        <span class="n">wlan0</span><span class="p">:</span>
            <span class="n">optional</span><span class="p">:</span> <span class="n">true</span>
            <span class="n">access</span><span class="o">-</span><span class="n">points</span><span class="p">:</span>
                <span class="s2">&quot;YOUR-SSID&quot;</span><span class="p">:</span>
                    <span class="n">password</span><span class="p">:</span> <span class="s2">&quot;YOUR-PASSWORD&quot;</span>
            <span class="n">dhcp4</span><span class="p">:</span> <span class="n">true</span>
</pre></div>
</div>
</li>
<li><p>Save and exit.</p></li>
<li><p>Apply your changes using the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>netplan<span class="w"> </span>apply
</pre></div>
</div>
<p>Alternatively, you can reboot your system and the changes will be automatically applied once the system boots.</p>
</li>
</ul>
</section>
<section id="static-ip-address-optional">
<h3>Static IP Address (Optional)<a class="headerlink" href="#static-ip-address-optional" title="Link to this heading">#</a></h3>
<p>It may be beneficial to setup a static IP address. To do this you need to determine your subnet and gateway.</p>
<ul>
<li><p>Determine subnet and gateway addresses:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>ubuntu@ubuntu:~$ ip route
default via 192.168.0.1 dev wlan0 proto static 
192.168.0.1/24 dev wlan0 proto kernel scope link src 192.168.0.201
</pre></div>
</div>
</li>
<li><p>Set static IP within subnet range:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># This file is generated from information provided by the datasource.  Changes</span>
<span class="c1"># to it will not persist across an instance reboot.  To disable cloud-init&#39;s  </span>
<span class="c1"># network configuration capabilities, write a file</span>
<span class="c1"># /etc/cloud/cloud.cfg.d/99-disable-network-config.cfg with the following:    </span>
<span class="c1"># network: {config: disabled}</span>
<span class="n">network</span><span class="p">:</span>
    <span class="n">ethernets</span><span class="p">:</span>
        <span class="n">eth0</span><span class="p">:</span>
            <span class="n">dhcp4</span><span class="p">:</span> <span class="n">true</span>
            <span class="n">optional</span><span class="p">:</span> <span class="n">true</span>
    <span class="n">version</span><span class="p">:</span> <span class="mi">2</span>
    <span class="n">wifis</span><span class="p">:</span>
        <span class="n">wlan0</span><span class="p">:</span>
            <span class="n">dhcp4</span><span class="p">:</span> <span class="n">no</span>
            <span class="n">access</span><span class="o">-</span><span class="n">points</span><span class="p">:</span>
                <span class="s2">&quot;robotics_5GHz&quot;</span><span class="p">:</span>
                    <span class="n">password</span><span class="p">:</span> <span class="s2">&quot;YOUR-PASSWORD&quot;</span>
            <span class="n">addresses</span><span class="p">:</span>
                <span class="o">-</span> <span class="mf">192.168.1.208</span><span class="o">/</span><span class="mi">24</span>
            <span class="n">routes</span><span class="p">:</span>
                <span class="o">-</span> <span class="n">to</span><span class="p">:</span> <span class="n">default</span>
                <span class="n">via</span><span class="p">:</span> <span class="mf">192.168.1.1</span>
            <span class="n">nameservers</span><span class="p">:</span>
                <span class="n">addresses</span><span class="p">:</span> <span class="p">[</span><span class="mf">192.168.1.1</span><span class="p">,</span> <span class="mf">8.8.8.8</span><span class="p">,</span> <span class="mf">1.1.1.1</span><span class="p">]</span>
            <span class="n">optional</span><span class="p">:</span> <span class="n">true</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="disable-automatic-updates">
<h3>Disable Automatic Updates<a class="headerlink" href="#disable-automatic-updates" title="Link to this heading">#</a></h3>
<p>Ubuntu will attempt to apply system updates in the background. This has caused issues in the past with ROS dependencies and keys. Disabling automatic updates allows you to control when Ubuntu installs updates. While this is not a good habit for general computer security, it is fine for this application of an embedded robotics system. Ensure you periodically update and upgrade your system.</p>
<ul>
<li><p>Open the auto updater configuration file using sudoedit:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudoedit<span class="w"> </span>/etc/apt/apt.conf.d/20auto-upgrades
</pre></div>
</div>
</li>
<li><p>Change the content from:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">APT</span><span class="p">::</span><span class="n">Periodic</span><span class="p">::</span><span class="n">Update</span><span class="o">-</span><span class="n">Package</span><span class="o">-</span><span class="n">Lists</span> <span class="s2">&quot;1&quot;</span><span class="p">;</span>
<span class="n">APT</span><span class="p">::</span><span class="n">Periodic</span><span class="p">::</span><span class="n">Unattended</span><span class="o">-</span><span class="n">Upgrade</span> <span class="s2">&quot;1&quot;</span><span class="p">;</span>
</pre></div>
</div>
<p>to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">APT</span><span class="p">::</span><span class="n">Periodic</span><span class="p">::</span><span class="n">Update</span><span class="o">-</span><span class="n">Package</span><span class="o">-</span><span class="n">Lists</span> <span class="s2">&quot;0&quot;</span><span class="p">;</span>
<span class="n">APT</span><span class="p">::</span><span class="n">Periodic</span><span class="p">::</span><span class="n">Unattended</span><span class="o">-</span><span class="n">Upgrade</span> <span class="s2">&quot;0&quot;</span><span class="p">;</span>
<span class="n">APT</span><span class="p">::</span><span class="n">Periodic</span><span class="p">::</span><span class="n">AutocleanInterval</span> <span class="s2">&quot;0&quot;</span><span class="p">;</span>
<span class="n">APT</span><span class="p">::</span><span class="n">Periodic</span><span class="p">::</span><span class="n">Download</span><span class="o">-</span><span class="n">Upgradeable</span><span class="o">-</span><span class="n">Packages</span> <span class="s2">&quot;0&quot;</span><span class="p">;</span>
</pre></div>
</div>
</li>
<li><p>Set the systemd to prevent boot-up delay even if there is no network at startup. Run the command below to set mask the systemd process using the following command.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ sudo systemctl mask systemd-networkd-wait-online.service
</pre></div>
</div>
</li>
<li><p>Disable Suspend and Hibernation</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ sudo systemctl mask sleep.target suspend.target hibernate.target hybrid-sleep.target
</pre></div>
</div>
</li>
<li><p>Reboot the Raspberry Pi.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ sudo reboot
</pre></div>
</div>
</li>
</ul>
</section>
<section id="verify-changes">
<h3>Verify changes<a class="headerlink" href="#verify-changes" title="Link to this heading">#</a></h3>
<ul>
<li><p>After reboot and you log in your new hostname should be listed at the terminal (e.g., <code class="docutils literal notranslate"><span class="pre">pi&#64;robot0</span></code>). Additionally, you should be connected to Wi-Fi and have an IP Address. You can confirm by typing the following and observing the IP address in the output:</p>
<p><img alt="logo" src="../_images/wifi3.png" /></p>
</li>
<li><p>You can now use this IP address to create a remote secure shell into the TurtleBot3 using either the IP address or hostname if your network provides Dynamic DNS. From another machine connected to your network type one of the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ssh<span class="w"> </span>username@IP_ADDRESS
</pre></div>
</div>
<p>or</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ssh<span class="w"> </span>username@HOSTNAME
</pre></div>
</div>
</li>
</ul>
</section>
<section id="update-and-upgrade">
<h3>Update and Upgrade<a class="headerlink" href="#update-and-upgrade" title="Link to this heading">#</a></h3>
<p>Since we turned off automatic updates, you should periodically update and upgrade. You can use this single command to accomplish both while accepting all upgrades:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>apt<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>sudo<span class="w"> </span>apt<span class="w"> </span>upgrade<span class="w"> </span>-y
</pre></div>
</div>
</section>
<section id="install-ubuntu-desktop-optional">
<h3>Install Ubuntu Desktop (optional)<a class="headerlink" href="#install-ubuntu-desktop-optional" title="Link to this heading">#</a></h3>
<p>A desktop GUI is <strong>not</strong> necessary for a remote machine like TurtleBot3 and will take up about 1.4 GB of RAM to run. If GUI is neccessary, the following will install the environment while confirming the installation:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>apt<span class="w"> </span>-y<span class="w"> </span>install<span class="w"> </span>ubuntu-desktop
</pre></div>
</div>
<p>If you do install the Ubuntu Desktop and want to use the GUI to setup the Wi-Fi network then you need to remove the settings included in the <code class="docutils literal notranslate"><span class="pre">/etc/netplan/50-cloud-init.yaml</span></code> file. It should look like the original file when complete:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># This file is generated from information provided by the datasource.  Changes</span>
<span class="c1"># to it will not persist across an instance reboot.  To disable cloud-init&#39;s  </span>
<span class="c1"># network configuration capabilities, write a file</span>
<span class="c1"># /etc/cloud/cloud.cfg.d/99-disable-network-config.cfg with the following:    </span>
<span class="c1"># network: {config: disabled}</span>
<span class="n">network</span><span class="p">:</span>
    <span class="n">ethernets</span><span class="p">:</span>
        <span class="n">eth0</span><span class="p">:</span>
            <span class="n">dhcp4</span><span class="p">:</span> <span class="n">true</span>
            <span class="n">optional</span><span class="p">:</span> <span class="n">true</span>
    <span class="n">version</span><span class="p">:</span> <span class="mi">2</span>
    <span class="n">wifis</span><span class="p">:</span>
        <span class="n">wlan0</span><span class="p">:</span>
             <span class="n">dhcp4</span><span class="p">:</span> <span class="n">true</span>
             <span class="n">optional</span><span class="p">:</span> <span class="n">true</span>
</pre></div>
</div>
<p>You can now use the GUI interface in the top right of the screen to set up a Wi-Fi connection.</p>
</section>
<section id="install-rtl8723bu-driver-ubuntu-22-04">
<h3>Install RTL8723BU driver (Ubuntu 22.04)<a class="headerlink" href="#install-rtl8723bu-driver-ubuntu-22-04" title="Link to this heading">#</a></h3>
<p>We use a WiFi dongle to create an access point, allowing a remote master computer to directly control the robot. The specific adapter is the <a class="reference external" href="https://www.adafruit.com/product/4827?srsltid=AfmBOorWVrVtwi3XuDb8Z2vIOsfrhc-y8ti8qm8orQDFAH0JVqh8e-_I">Xinghuatian Tech Combination WiFi + Bluetooth¬Æ 4.0 USB Adapter</a></p>
<ul>
<li><p>Install build prerequisites</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>apt<span class="w"> </span>update
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>git<span class="w"> </span>dkms<span class="w"> </span>build-essential<span class="w"> </span>linux-headers-<span class="k">$(</span>uname<span class="w"> </span>-r<span class="k">)</span>
</pre></div>
</div>
</li>
<li><p>Remove any conflicting Realtek modules</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>modprobe<span class="w"> </span>-r<span class="w"> </span>rtw88_8723b<span class="w"> </span><span class="m">2</span>&gt;/dev/null
sudo<span class="w"> </span>modprobe<span class="w"> </span>-r<span class="w"> </span>rtl8723bu<span class="w"> </span><span class="m">2</span>&gt;/dev/null
</pre></div>
</div>
<p>(Optional) Verify no 8723 modules are loaded.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>lsmod<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="m">8723</span>
</pre></div>
</div>
</li>
<li><p>Install the RTL8723BU Driver.  The recommended repository is <a class="github reference external" href="https://github.com/lwfinger/rtl8723bu.git">lwfinger/rtl8723bu.git</a>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Clone the repository</span>
git<span class="w"> </span>clone<span class="w"> </span>https://github.com/lwfinger/rtl8723bu.git
<span class="nb">cd</span><span class="w"> </span>rtl8723bu

<span class="c1"># Read package info from dkms.conf</span>
<span class="nb">source</span><span class="w"> </span>dkms.conf

<span class="c1"># Create and populate the DKMS source directory</span>
sudo<span class="w"> </span>mkdir<span class="w"> </span>-p<span class="w"> </span>/usr/src/<span class="nv">$PACKAGE_NAME</span>-<span class="nv">$PACKAGE_VERSION</span>
sudo<span class="w"> </span>cp<span class="w"> </span>-r<span class="w"> </span>core<span class="w"> </span>hal<span class="w"> </span>include<span class="w"> </span>os_dep<span class="w"> </span>platform<span class="w"> </span>dkms.conf<span class="w"> </span>Makefile<span class="w"> </span>rtl8723b_fw.bin<span class="w"> </span>/usr/src/<span class="nv">$PACKAGE_NAME</span>-<span class="nv">$PACKAGE_VERSION</span>

<span class="c1"># Add and install the DKMS module</span>
sudo<span class="w"> </span>dkms<span class="w"> </span>add<span class="w"> </span><span class="nv">$PACKAGE_NAME</span>/<span class="nv">$PACKAGE_VERSION</span>
sudo<span class="w"> </span>dkms<span class="w"> </span>autoinstall<span class="w"> </span><span class="nv">$PACKAGE_NAME</span>/<span class="nv">$PACKAGE_VERSION</span>
</pre></div>
</div>
</li>
<li><p>Load the module</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>modprobe<span class="w"> </span>rtl8723bu
lsmod<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="m">8723</span>
</pre></div>
</div>
<p>It should display something like:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>8723bu<span class="w">               </span><span class="m">1048576</span><span class="w">  </span><span class="m">0</span>
cfg80211<span class="w">              </span><span class="m">970752</span><span class="w">  </span><span class="m">4</span><span class="w"> </span>brcmfmac,mac80211,8723bu,rtl8xxxu
</pre></div>
</div>
</li>
<li><p>Rename the interface: Currently, <code class="docutils literal notranslate"><span class="pre">ip</span> <span class="pre">addr</span></code> shows the WiFi dongle with varying names (e.g., wlx1cbfcee6196b). We want to standardize this to <code class="docutils literal notranslate"><span class="pre">wlan1</span></code> across all robots.</p>
<p>Here is the most effective way to ensure that the external dongle is always named <code class="docutils literal notranslate"><span class="pre">wlan1</span></code> across all your Raspberry Pis, regardless of its MAC address. On the Raspberry Pi 4, the built-in WiFi will grab wlan0, and the first USB dongle detected will grab wlan1.</p>
<p>Edit the boot configuration: On Ubuntu for Raspberry Pi, the kernel boot parameters are stored in a specific text file.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>nano<span class="w"> </span>/boot/firmware/cmdline.txt
</pre></div>
</div>
<p>Add naming parameters: Stay on the same line (do not create a new line). Go to the end of the existing text and add a space followed by:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">ifnames</span><span class="o">=</span><span class="mi">0</span> <span class="n">biosdevname</span><span class="o">=</span><span class="mi">0</span>
</pre></div>
</div>
<p>Save and Reboot.  After rebooting, your interfaces will no longer have long names like wlx1cbfcee6196b. Your dongle will almost certainly be wlan1.</p>
</li>
</ul>
</section>
</section>
<section id="dual-wi-fi-setup-client-access-point">
<h2>Dual Wi-Fi Setup (Client + Access Point)<a class="headerlink" href="#dual-wi-fi-setup-client-access-point" title="Link to this heading">#</a></h2>
<p>In this configuration, the TurtleBot3 uses <strong>two independent Wi-Fi interfaces</strong>:</p>
<ul class="simple">
<li><p>One interface connects to an existing Wi-Fi network for <strong>internet access</strong></p></li>
<li><p>The second interface runs as a <strong>dedicated Access Point (AP)</strong> for direct, low-latency communication with a remote master computer (NUC or laptop)</p></li>
</ul>
<p>This design avoids routing complexity and provides a stable ROS2 communication link.</p>
<section id="goal-final-architecture">
<h3>GOAL (Final Architecture)<a class="headerlink" href="#goal-final-architecture" title="Link to this heading">#</a></h3>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Interface</p></th>
<th class="head"><p>Hardware</p></th>
<th class="head"><p>Role</p></th>
<th class="head"><p>Network</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">wlan0</span></code></p></td>
<td><p>Built-in Raspberry Pi Wi-Fi</p></td>
<td><p><strong>Access Point (AP)</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">robotXX</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">wlan1</span></code></p></td>
<td><p>USB Wi-Fi (RTL8723BU)</p></td>
<td><p><strong>Wi-Fi client ‚Üí router</strong></p></td>
<td><p>Router</p></td>
</tr>
<tr class="row-even"><td><p>Master PC</p></td>
<td><p>Built-in &amp; USB Wi-Fi</p></td>
<td><p>Connects to AP + Internet</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">robotXX</span></code> + Router</p></td>
</tr>
</tbody>
</table>
</div>
<ul class="simple">
<li><p><strong>No NAT or packet forwarding</strong></p></li>
<li><p><strong>No NetworkManager</strong></p></li>
<li><p>Laptop/NUC maintains its own internet connection</p></li>
</ul>
</section>
<section id="verify-interfaces">
<h3>Verify Interfaces<a class="headerlink" href="#verify-interfaces" title="Link to this heading">#</a></h3>
<ul>
<li><p>Confirm that both interfaces exist:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ip<span class="w"> </span>link
</pre></div>
</div>
<p>You are expected:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>wlan0   ‚Üê built-in Wi-Fi
wlan1   ‚Üê USB Wi-Fi dongle
</pre></div>
</div>
</li>
<li><p>Verify that the RTL8723BU driver is loaded:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>lsmod<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="m">8723</span>
</pre></div>
</div>
<p>You should see:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>8723bu
</pre></div>
</div>
</li>
</ul>
</section>
<section id="configure-wi-fi-client-internet-wlan1">
<h3>Configure Wi-Fi Client (Internet) ‚Äî <code class="docutils literal notranslate"><span class="pre">wlan1</span></code><a class="headerlink" href="#configure-wi-fi-client-internet-wlan1" title="Link to this heading">#</a></h3>
<p>This configures the USB WiFi dongle to connect to a 2.4 GHz network for internet access. The built-in 5 GHz adapter will then be available for a direct, high-bandwidth connection to the remote master PC.</p>
<ul>
<li><p>The USB Wi-Fi dongle (<code class="docutils literal notranslate"><span class="pre">wlan1</span></code>) will connect to your router to provide internet access. Edit the Netplan configuration:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>nano<span class="w"> </span>/etc/netplan/50-cloud-init.yaml
</pre></div>
</div>
<p>Update it as shown below (replace SSID and password):</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">network</span><span class="p">:</span>
<span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="nt">ethernets</span><span class="p">:</span>
<span class="w">    </span><span class="nt">eth0</span><span class="p">:</span>
<span class="w">    </span><span class="nt">dhcp4</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">optional</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="nt">wifis</span><span class="p">:</span>
<span class="w">    </span><span class="nt">wlan1</span><span class="p">:</span>
<span class="w">    </span><span class="nt">dhcp4</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">optional</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">regulatory-domain</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">US</span>
<span class="w">    </span><span class="nt">access-points</span><span class="p">:</span>
<span class="w">        </span><span class="s">&quot;ECE&quot;</span><span class="p p-Indicator">:</span>
<span class="w">        </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;YOUR_ROUTER_PASSWORD&quot;</span>
</pre></div>
</div>
</li>
<li><p>Fix permissions and apply:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>chmod<span class="w"> </span><span class="m">600</span><span class="w"> </span>/etc/netplan/50-cloud-init.yaml
sudo<span class="w"> </span>netplan<span class="w"> </span>apply
</pre></div>
</div>
</li>
<li><p>Verify that <code class="docutils literal notranslate"><span class="pre">wlan1</span></code> received an IP address:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ip<span class="w"> </span>addr<span class="w"> </span>show<span class="w"> </span>wlan1
</pre></div>
</div>
<p>You should see:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>inet 192.168.x.x
</pre></div>
</div>
</li>
</ul>
</section>
<section id="configure-static-ip-for-access-point-wlan0">
<h3>Configure Static IP for Access Point ‚Äî <code class="docutils literal notranslate"><span class="pre">wlan0</span></code><a class="headerlink" href="#configure-static-ip-for-access-point-wlan0" title="Link to this heading">#</a></h3>
<p>The built-in Wi-Fi (<code class="docutils literal notranslate"><span class="pre">wlan0</span></code>) will act as an access point with a <strong>fixed IP address</strong>.</p>
<ul>
<li><p>Edit <code class="docutils literal notranslate"><span class="pre">dhcpcd</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>nano<span class="w"> </span>/etc/dhcpcd.conf
</pre></div>
</div>
<p>Add the following at the end of the file:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">interface wlan0</span>
<span class="na">static ip_address</span><span class="o">=</span><span class="s">192.168.50.1/24</span>
<span class="na">nohook wpa_supplicant</span>
</pre></div>
</div>
</li>
<li><p>Restart the service:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>dhcpcd
</pre></div>
</div>
</li>
</ul>
</section>
<hr class="docutils" />
<section id="configure-dhcp-for-ap-clients-dnsmasq">
<h3>Configure DHCP for AP Clients (dnsmasq)<a class="headerlink" href="#configure-dhcp-for-ap-clients-dnsmasq" title="Link to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">dnsmasq</span></code> service assigns IP addresses to devices that connect to the robot‚Äôs AP.</p>
<ul>
<li><p>Install and configure:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>apt<span class="w"> </span>update
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>dnsmasq
</pre></div>
</div>
</li>
<li><p>Backup the default configuration:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>mv<span class="w"> </span>/etc/dnsmasq.conf<span class="w"> </span>/etc/dnsmasq.conf.orig
sudo<span class="w"> </span>nano<span class="w"> </span>/etc/dnsmasq.conf
</pre></div>
</div>
<p>Paste:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">interface</span><span class="o">=</span><span class="s">wlan0</span>
<span class="na">bind-interfaces</span>

<span class="c1"># Disable DNS (DHCP only)</span>
<span class="na">port</span><span class="o">=</span><span class="s">0</span>

<span class="c1"># 72-hour lease for student labs</span>
<span class="na">dhcp-range</span><span class="o">=</span><span class="s">192.168.50.10,192.168.50.50,255.255.255.0,72h</span>
</pre></div>
</div>
</li>
<li><p>Enable and restart:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>hostapd
sudo<span class="w"> </span>systemctl<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>dnsmasq
sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>dnsmasq
</pre></div>
</div>
</li>
</ul>
</section>
<section id="what-controls-the-ap-instead">
<h3>What controls the AP instead<a class="headerlink" href="#what-controls-the-ap-instead" title="Link to this heading">#</a></h3>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Component</p></th>
<th class="head"><p>Purpose</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dhcpcd.conf</span></code></p></td>
<td><p>Static IP for <code class="docutils literal notranslate"><span class="pre">wlan0</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dnsmasq</span></code></p></td>
<td><p>DHCP for clients</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hostapd</span></code></p></td>
<td><p>Wi-Fi AP</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">systemd</span></code></p></td>
<td><p>Startup ordering</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="hostapd-configuration-template">
<h3>Hostapd Configuration Template<a class="headerlink" href="#hostapd-configuration-template" title="Link to this heading">#</a></h3>
<p>Instead of hard-coding the SSID, we make it <strong>automatically follow the robot hostname</strong>.
This allows you to clone SD cards without manual edits.</p>
<ul>
<li><p>Create the template:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>nano<span class="w"> </span>/etc/hostapd/hostapd.conf.template
</pre></div>
</div>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">interface</span><span class="o">=</span><span class="s">wlan0</span>
<span class="na">driver</span><span class="o">=</span><span class="s">nl80211</span>

<span class="na">ssid</span><span class="o">=</span><span class="s">__HOSTNAME__</span>

<span class="c1"># 5 GHz band</span>
<span class="na">hw_mode</span><span class="o">=</span><span class="s">a</span>
<span class="na">channel</span><span class="o">=</span><span class="s">36</span>
<span class="na">ieee80211n</span><span class="o">=</span><span class="s">1</span>
<span class="na">ieee80211ac</span><span class="o">=</span><span class="s">1</span>
<span class="na">country_code</span><span class="o">=</span><span class="s">US</span>

<span class="c1"># Security</span>
<span class="na">auth_algs</span><span class="o">=</span><span class="s">1</span>
<span class="na">wpa</span><span class="o">=</span><span class="s">2</span>
<span class="na">wpa_passphrase</span><span class="o">=</span><span class="s">dfec3141</span>
<span class="na">wpa_key_mgmt</span><span class="o">=</span><span class="s">WPA-PSK</span>
<span class="na">rsn_pairwise</span><span class="o">=</span><span class="s">CCMP</span>

<span class="na">ignore_broadcast_ssid</span><span class="o">=</span><span class="s">0</span>
</pre></div>
</div>
</li>
<li><p>Create the generator script:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>nano<span class="w"> </span>/usr/local/bin/gen-hostapd-conf.sh
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="nv">HOSTNAME</span><span class="o">=</span><span class="k">$(</span>hostname<span class="k">)</span>
sed<span class="w"> </span><span class="s2">&quot;s/__HOSTNAME__/</span><span class="si">${</span><span class="nv">HOSTNAME</span><span class="si">}</span><span class="s2">/g&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>/etc/hostapd/hostapd.conf.template<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>&gt;<span class="w"> </span>/etc/hostapd/hostapd.conf
</pre></div>
</div>
<p>Make it executable:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>chmod<span class="w"> </span>+x<span class="w"> </span>/usr/local/bin/gen-hostapd-conf.sh
</pre></div>
</div>
</li>
</ul>
</section>
<section id="systemd-service-for-automatic-ssid-update">
<h3>Systemd Service for Automatic SSID Update<a class="headerlink" href="#systemd-service-for-automatic-ssid-update" title="Link to this heading">#</a></h3>
<ul>
<li><p>Edit</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>nano<span class="w"> </span>/etc/systemd/system/hostapd-genconf.service
</pre></div>
</div>
</li>
<li><p>Add</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[Unit]</span>
<span class="na">Description</span><span class="o">=</span><span class="s">Generate hostapd config from hostname</span>
<span class="na">Before</span><span class="o">=</span><span class="s">hostapd.service</span>

<span class="k">[Service]</span>
<span class="na">Type</span><span class="o">=</span><span class="s">oneshot</span>
<span class="na">ExecStart</span><span class="o">=</span><span class="s">/usr/local/bin/gen-hostapd-conf.sh</span>

<span class="k">[Install]</span>
<span class="na">WantedBy</span><span class="o">=</span><span class="s">multi-user.target</span>
</pre></div>
</div>
</li>
<li><p>Enable it:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>systemctl<span class="w"> </span>daemon-reexec
sudo<span class="w"> </span>systemctl<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>hostapd-genconf.service
</pre></div>
</div>
</li>
<li><p>Tell systemd where hostapd config lives:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>nano<span class="w"> </span>/etc/default/hostapd
</pre></div>
</div>
<p>Set:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">DAEMON_CONF</span><span class="o">=</span><span class="s">&quot;/etc/hostapd/hostapd.conf&quot;</span>
</pre></div>
</div>
</li>
<li><p>Start the access point</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>systemctl<span class="w"> </span>unmask<span class="w"> </span>hostapd
sudo<span class="w"> </span>systemctl<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>hostapd
sudo<span class="w"> </span>systemctl<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>dnsmasq

sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>systemd-networkd
sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>hostapd
sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>dnsmasq
</pre></div>
</div>
</li>
<li><p>Verify:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>systemctl<span class="w"> </span>status<span class="w"> </span>hostapd
</pre></div>
</div>
<p>You should see:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>AP-ENABLED
</pre></div>
</div>
</li>
</ul>
</section>
<section id="disable-cloud-init-hostname-reset-important">
<h3>Disable cloud-init Hostname Reset (IMPORTANT)<a class="headerlink" href="#disable-cloud-init-hostname-reset-important" title="Link to this heading">#</a></h3>
<p>By default, <strong>cloud-init resets the hostname on every boot</strong>, which breaks the automatic SSID feature.</p>
<ul>
<li><p>Create the override:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>nano<span class="w"> </span>/etc/cloud/cloud.cfg.d/99-disable-hostname.cfg
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">preserve_hostname</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</pre></div>
</div>
</li>
<li><p>Edit the main config:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>nano<span class="w"> </span>/etc/cloud/cloud.cfg
</pre></div>
</div>
<p>Change:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">preserve_hostname</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</pre></div>
</div>
<p>to:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">preserve_hostname</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="final-verification">
<h3>Final Verification<a class="headerlink" href="#final-verification" title="Link to this heading">#</a></h3>
<ul>
<li><p>After reboot:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>hostname
</pre></div>
</div>
<p>SSID should match hostname (e.g., <code class="docutils literal notranslate"><span class="pre">robot42</span></code>).</p>
</li>
<li><p>Check interfaces:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ip<span class="w"> </span>addr<span class="w"> </span>show<span class="w"> </span>wlan0<span class="w">   </span><span class="c1"># 192.168.50.1</span>
ip<span class="w"> </span>addr<span class="w"> </span>show<span class="w"> </span>wlan1<span class="w">   </span><span class="c1"># Router IP</span>
</pre></div>
</div>
</li>
<li><p>From the master computer:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ssh<span class="w"> </span>pi@192.168.50.1
</pre></div>
</div>
</li>
</ul>
</section>
</section>
<section id="ros2-humble">
<h2>ROS2 Humble<a class="headerlink" href="#ros2-humble" title="Link to this heading">#</a></h2>
<p>At this point, the Ubuntu environment is setup. Now we will setup the ROS requirements for the TurtleBot3. All of these instructions are adapted from the <a class="reference external" href="https://docs.ros.org/en/humble/Installation/Ubuntu-Install-Debians.html">ROS2 Documentation</a> and <a class="reference external" href="https://roboticsbackend.com/install-ros2-on-raspberry-pi/">The Robotics Back-End</a>
. ROS 2 Humble is the latest version of ROS 2 that supports Ubuntu 22.04.</p>
<section id="installation">
<h3>Installation<a class="headerlink" href="#installation" title="Link to this heading">#</a></h3>
<p>Make sure you have a locale which supports UTF-8.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>locale<span class="w">  </span><span class="c1"># check for UTF-8</span>

sudo<span class="w"> </span>apt<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>locales
sudo<span class="w"> </span>locale-gen<span class="w"> </span>en_US<span class="w"> </span>en_US.UTF-8
sudo<span class="w"> </span>update-locale<span class="w"> </span><span class="nv">LC_ALL</span><span class="o">=</span>en_US.UTF-8<span class="w"> </span><span class="nv">LANG</span><span class="o">=</span>en_US.UTF-8
<span class="nb">export</span><span class="w"> </span><span class="nv">LANG</span><span class="o">=</span>en_US.UTF-8

locale<span class="w">  </span><span class="c1"># verify settings</span>
</pre></div>
</div>
<p>First ensure that the Ubuntu Universe repository is enabled.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>software-properties-common
sudo<span class="w"> </span>add-apt-repository<span class="w"> </span>universe
</pre></div>
</div>
<p>Set up keys:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>apt<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>curl<span class="w"> </span>-y
sudo<span class="w"> </span>curl<span class="w"> </span>-sSL<span class="w"> </span>https://raw.githubusercontent.com/ros/rosdistro/master/ros.key<span class="w"> </span>-o<span class="w"> </span>/usr/share/keyrings/ros-archive-keyring.gpg
</pre></div>
</div>
<p>Then add the repository to your sources list.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;deb [arch=</span><span class="k">$(</span>dpkg<span class="w"> </span>--print-architecture<span class="k">)</span><span class="s2"> signed-by=/usr/share/keyrings/ros-archive-keyring.gpg] http://packages.ros.org/ros2/ubuntu </span><span class="k">$(</span>.<span class="w"> </span>/etc/os-release<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="nv">$UBUNTU_CODENAME</span><span class="k">)</span><span class="s2"> main&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>/etc/apt/sources.list.d/ros2.list<span class="w"> </span>&gt;<span class="w"> </span>/dev/null
</pre></div>
</div>
<p>Install ROS 2 Humble:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>apt<span class="w"> </span>update
sudo<span class="w"> </span>apt<span class="w"> </span>upgrade
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>ros-humble-ros-base
</pre></div>
</div>
<p>The base version provides the Bare Bones of ROS 2 to include minimum packaging, build, and communications libraries. No GUI tools are installed. As the Raspberry Pi is embedded into TurtleBot it is ideal to keep overhead as low as possible. Many of the GUI tools will be ran on the main machine.</p>
<p>Install colcon (build tool)</p>
<p>ROS2 uses colcon as a build tool (and ament as the build system). When you only install the ROS2 core packages, colcon is not here, so install it manually.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>python3-colcon-common-extensions
</pre></div>
</div>
</section>
<section id="configuring-ros2-environment">
<h3>Configuring ROS2 Environment<a class="headerlink" href="#configuring-ros2-environment" title="Link to this heading">#</a></h3>
<p>Ref: <a class="reference external" href="https://docs.ros.org/en/humble/Tutorials/Beginner-CLI-Tools/Configuring-ROS2-Environment.html">https://docs.ros.org/en/humble/Tutorials/Beginner-CLI-Tools/Configuring-ROS2-Environment.html</a></p>
<p>Setup ROS environment variables and setup scripts within the <code class="docutils literal notranslate"><span class="pre">~/.bashrc</span></code> file. If you don‚Äôt want to have to source the setup file every time you open a new shell, then add the command to your shell startup script:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;source /opt/ros/humble/setup.bash&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>~/.bashrc
</pre></div>
</div>
<p>Any time you make changes to your <code class="docutils literal notranslate"><span class="pre">~/.bashrc</span></code> file you must source it:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">source</span><span class="w"> </span>~/.bashrc
</pre></div>
</div>
<p>Sourcing ROS 2 setup files will set several environment variables necessary for operating ROS 2. If you ever have problems finding or using your ROS 2 packages, make sure that your environment is properly set up using the following command:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>printenv<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-i<span class="w"> </span>ROS
</pre></div>
</div>
<p>Check that variables like ROS_DISTRO and ROS_VERSION are set.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nv">ROS_VERSION</span><span class="o">=</span><span class="m">2</span>
<span class="nv">ROS_PYTHON_VERSION</span><span class="o">=</span><span class="m">3</span>
<span class="nv">ROS_DISTRO</span><span class="o">=</span>humble
</pre></div>
</div>
<p>ROS 2 nodes on the same domain can freely discover and send messages to each other, while ROS 2 nodes on different domains cannot. All ROS 2 nodes use domain ID 0 by default. To avoid interference between different groups of computers running ROS 2 on the same network, a different domain ID should be set for each group.</p>
<p>We can simply choose a domain ID between 0 and 101, inclusive, but for ECE387, we choose X for RobotX and MasterX. Once you have determined a unique integer for your group of ROS 2 nodes, you can set the environment variable with the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">echo</span> <span class="s2">&quot;export ROS_DOMAIN_ID=&lt;your_domain_id&gt;&quot;</span> <span class="o">&gt;&gt;</span> <span class="o">~/.</span><span class="n">bashrc</span>
</pre></div>
</div>
</section>
<section id="install-and-build-ros2-packages">
<h3>Install and Build ROS2 Packages<a class="headerlink" href="#install-and-build-ros2-packages" title="Link to this heading">#</a></h3>
<p>This section installs the minimum system, ROS 2, and sensor packages required to run TurtleBot3 on ROS 2 Humble.</p>
<ul>
<li><p>Install the core build tools that are required to compile and build ROS 2 packages using <code class="docutils literal notranslate"><span class="pre">colcon</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>python3-argcomplete<span class="w"> </span>python3-colcon-common-extensions<span class="w"> </span>libboost-system-dev<span class="w"> </span>build-essential
</pre></div>
</div>
</li>
<li><p>TurtleBot3 ROS 2 Dependencies: drivers and message definitions for LiDAR, motors, URDF, and USB devices.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>ros-humble-hls-lfcd-lds-driver
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>ros-humble-turtlebot3-msgs
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>ros-humble-dynamixel-sdk
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>ros-humble-xacro
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>libudev-dev
</pre></div>
</div>
</li>
<li><p>Create workspace and clone repositories</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>mkdir<span class="w"> </span>-p<span class="w"> </span>~/robot_ws/src<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>~/robot_ws/src
$<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>-b<span class="w"> </span>humble<span class="w"> </span>https://github.com/ROBOTIS-GIT/turtlebot3.git
$<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>-b<span class="w"> </span>humble<span class="w"> </span>https://github.com/ROBOTIS-GIT/ld08_driver.git
$<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>-b<span class="w"> </span>humble<span class="w"> </span>https://github.com/ROBOTIS-GIT/coin_d4_driver
</pre></div>
</div>
</li>
<li><p>Remove unused navigation packages to reduces build time and memory usage on the Raspberry Pi.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>~/robot_ws/src/turtlebot3
rm<span class="w"> </span>-r<span class="w"> </span>turtlebot3_cartographer<span class="w"> </span>turtlebot3_navigation2
</pre></div>
</div>
</li>
<li><p>Build and source workspace</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">source</span><span class="w"> </span>~/.bashrc
<span class="nb">cd</span><span class="w"> </span>~/robot_ws
colcon<span class="w"> </span>build<span class="w"> </span>--symlink-install<span class="w"> </span>--parallel-workers<span class="w"> </span><span class="m">1</span>
<span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;source ~/robot_ws/install/setup.bash&#39;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>~/.bashrc
<span class="nb">source</span><span class="w"> </span>~/.bashrc
</pre></div>
</div>
</li>
</ul>
</section>
<section id="usb-port-setting-for-opencr">
<h3>USB Port Setting for OpenCR<a class="headerlink" href="#usb-port-setting-for-opencr" title="Link to this heading">#</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>```bash
sudo cp `ros2 pkg prefix turtlebot3_bringup`/share/turtlebot3_bringup/script/99-turtlebot3-cdc.rules /etc/udev/rules.d/
sudo udevadm control --reload-rules
sudo udevadm trigger
```
</pre></div>
</div>
</section>
<section id="lds-configuration">
<h3>LDS Configuration<a class="headerlink" href="#lds-configuration" title="Link to this heading">#</a></h3>
<p>The TurtleBot3 LDS has been updated to LDS-02 since 2022. For the Turtlebots we have purchased after 2022, use LDS-02 for the LDS_MODEL.</p>
<a class="reference internal image-reference" href="../_images/lds_small.png"><img alt="../_images/lds_small.png" class="align-center" src="../_images/lds_small.png" style="width: 420px;" />
</a>
<br>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">echo</span> <span class="s1">&#39;export LDS_MODEL=LDS-02&#39;</span> <span class="o">&gt;&gt;</span> <span class="o">~/.</span><span class="n">bashrc</span>
<span class="n">echo</span> <span class="s1">&#39;export TURTLEBOT3_MODEL=burger&#39;</span> <span class="o">&gt;&gt;</span> <span class="o">~/.</span><span class="n">bashrc</span>
</pre></div>
</div>
</section>
<section id="install-software-for-ece-387">
<h3>Install software for ECE 387<a class="headerlink" href="#install-software-for-ece-387" title="Link to this heading">#</a></h3>
<ul>
<li><p>Install USB camera drivers and OpenCV image support.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>python3-pip
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>ros-humble-usb-cam<span class="w"> </span>ros-humble-image-proc
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>ros-humble-v4l2-camera
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>python3-opencv<span class="w"> </span>ros-humble-cv-bridge
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>tree
</pre></div>
</div>
</li>
<li><p>Install the common Python libraries used in perception and vision labs.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span><span class="s2">&quot;pydantic&lt;2&quot;</span>
pip<span class="w"> </span>install<span class="w"> </span>dlib<span class="w"> </span>imutils<span class="w"> </span>scipy
</pre></div>
</div>
</li>
<li><p>Install Apriltags libraries</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>--user<span class="w"> </span>scikit-build<span class="w"> </span>cmake
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>libapriltag-dev<span class="w"> </span>python3-dev<span class="w"> </span>cmake<span class="w"> </span>libatlas-base-dev
pip<span class="w"> </span>install<span class="w"> </span>pupil-apriltags
</pre></div>
</div>
</li>
</ul>
</section>
<section id="camera-permissions">
<h3>Camera Permissions<a class="headerlink" href="#camera-permissions" title="Link to this heading">#</a></h3>
<ul>
<li><p>Should run this for each user</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>adduser<span class="w"> </span><span class="nv">$USER</span><span class="w"> </span>video
</pre></div>
</div>
<p>or replace <span class="math notranslate nohighlight">\(USER\)</span> with user ID.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>adduser<span class="w"> </span>pi<span class="w"> </span>video
</pre></div>
</div>
<p>This allows access to <code class="docutils literal notranslate"><span class="pre">/dev/video*</span></code> devices.</p>
</li>
<li><p>Then, reboot the system.</p></li>
</ul>
</section>
<section id="updating-opencr-firmware">
<h3>Updating OpenCR firmware<a class="headerlink" href="#updating-opencr-firmware" title="Link to this heading">#</a></h3>
<p>The last step is updating the firmware for the OpenCR controller board.</p>
<p>Ref: <a class="reference external" href="https://emanual.robotis.com/docs/en/platform/turtlebot3/opencr_setup/#opencr-setup">https://emanual.robotis.com/docs/en/platform/turtlebot3/opencr_setup/#opencr-setup</a></p>
<ul>
<li><p>Install required packages on the Raspberry Pi</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>dpkg<span class="w"> </span>--add-architecture<span class="w"> </span>armhf
sudo<span class="w"> </span>apt<span class="w"> </span>update
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>libc6:armhf
</pre></div>
</div>
</li>
<li><p>Setup the OpenCR model name:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span><span class="w"> </span><span class="nv">OPENCR_PORT</span><span class="o">=</span>/dev/ttyACM0
<span class="nb">export</span><span class="w"> </span><span class="nv">OPENCR_MODEL</span><span class="o">=</span>burger
rm<span class="w"> </span>-rf<span class="w"> </span>./opencr_update.tar.bz2
</pre></div>
</div>
</li>
<li><p>Download the firmware and loader, then extract the file:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>wget<span class="w"> </span>https://github.com/ROBOTIS-GIT/OpenCR-Binaries/raw/master/turtlebot3/ROS2/latest/opencr_update.tar.bz2
tar<span class="w"> </span>-xvf<span class="w"> </span>./opencr_update.tar.bz2
</pre></div>
</div>
</li>
<li><p>Upload firmware to the OpenCR:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>~/opencr_update
./update.sh<span class="w"> </span><span class="nv">$OPENCR_PORT</span><span class="w"> </span><span class="nv">$OPENCR_MODEL</span>.opencr
</pre></div>
</div>
<p>A successful firmware upload for TurtleBot3 Burger will look like:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pi@robot99:<span class="w"> </span>~/Downloads/opencr_update
$<span class="w"> </span>./update.sh<span class="w"> </span><span class="nv">$OPENCR_PORT</span><span class="w"> </span><span class="nv">$OPENCR_MODEL</span>.opencr
aarch64
arm
OpenCR<span class="w"> </span>Update<span class="w"> </span>Start..
opencr_ld_shell<span class="w"> </span>ver<span class="w"> </span><span class="m">1</span>.0.0
opencr_ld_main
<span class="o">[</span><span class="w">  </span><span class="o">]</span><span class="w"> </span>file<span class="w"> </span>name<span class="w">          </span>:<span class="w"> </span>burger.opencr
<span class="o">[</span><span class="w">  </span><span class="o">]</span><span class="w"> </span>file<span class="w"> </span>size<span class="w">          </span>:<span class="w"> </span><span class="m">136</span><span class="w"> </span>KB
<span class="o">[</span><span class="w">  </span><span class="o">]</span><span class="w"> </span>fw_name<span class="w">            </span>:<span class="w"> </span>burger
<span class="o">[</span><span class="w">  </span><span class="o">]</span><span class="w"> </span>fw_ver<span class="w">             </span>:<span class="w"> </span>V230127R1
<span class="o">[</span>OK<span class="o">]</span><span class="w"> </span>Open<span class="w"> </span>port<span class="w">          </span>:<span class="w"> </span>/dev/ttyACM0
<span class="o">[</span><span class="w">  </span><span class="o">]</span>
<span class="o">[</span><span class="w">  </span><span class="o">]</span><span class="w"> </span>Board<span class="w"> </span>Name<span class="w">         </span>:<span class="w"> </span>OpenCR<span class="w"> </span>R1.0
<span class="o">[</span><span class="w">  </span><span class="o">]</span><span class="w"> </span>Board<span class="w"> </span>Ver<span class="w">          </span>:<span class="w"> </span>0x17020800
<span class="o">[</span><span class="w">  </span><span class="o">]</span><span class="w"> </span>Board<span class="w"> </span>Rev<span class="w">          </span>:<span class="w"> </span>0x00000000
<span class="o">[</span>OK<span class="o">]</span><span class="w"> </span>flash_erase<span class="w">        </span>:<span class="w"> </span><span class="m">0</span>.95s
<span class="o">[</span>OK<span class="o">]</span><span class="w"> </span>flash_write<span class="w">        </span>:<span class="w"> </span><span class="m">1</span>.31s
<span class="o">[</span>OK<span class="o">]</span><span class="w"> </span>CRC<span class="w"> </span>Check<span class="w">          </span>:<span class="w"> </span>D92222<span class="w"> </span>D92222<span class="w"> </span>,<span class="w"> </span><span class="m">0</span>.004000<span class="w"> </span>sec
<span class="o">[</span>OK<span class="o">]</span><span class="w"> </span>Download
<span class="o">[</span>OK<span class="o">]</span><span class="w"> </span>jump_to_fw
</pre></div>
</div>
</li>
<li><p>If not successful, attempt the debug methods in the <a class="reference external" href="https://emanual.robotis.com/docs/en/platform/turtlebot3/opencr_setup/#opencr-setup">OpenCR Setup</a> guide.</p></li>
</ul>
</section>
</section>
<section id="setup-github-ssh-keys">
<h2>Setup GitHub SSH Keys<a class="headerlink" href="#setup-github-ssh-keys" title="Link to this heading">#</a></h2>
<p>The following assumes you already have a GitHub account.</p>
<ul>
<li><p>Create SSH keys to use with your GitHub account by typing the following using the same email as you GitHub login:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span>
ssh-keygen<span class="w"> </span>-t<span class="w"> </span>ed25519<span class="w"> </span>-C<span class="w"> </span><span class="s2">&quot;github@email.com&quot;</span>
</pre></div>
</div>
<p>When prompted to ‚ÄúEnter a file in which to save the key‚Äù, hit <strong>enter</strong>.</p>
</li>
<li><p>Start the ssh-agent in the background and add your SSH private key to the ssh-agent:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">eval</span><span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>ssh-agent<span class="w"> </span>-s<span class="k">)</span><span class="s2">&quot;</span>
ssh-add<span class="w"> </span>~/.ssh/id_ed25519
</pre></div>
</div>
</li>
<li><p>Open the public key with your favorite command line editor (this is easier to accomplish via an SSH connection from a desktop machine with a GUI so you can copy the public key to your GitHub account).</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>nano<span class="w"> </span>~/.ssh/id_ed25519.pub
</pre></div>
</div>
<p>Copy the contents of the file (maximize the window and ensure you copy the entire contents up to the GitHub email).</p>
</li>
<li><p>Open a web browser and sign in to your GitHub account. In the upper-right corner of any page, click your profile photo, then click <strong>Settings</strong>:</p>
  <br>
<a class="reference internal image-reference" href="../_images/ssh1.png"><img alt="../_images/ssh1.png" class="align-center" src="../_images/ssh1.png" style="width: 240px;" />
</a>
  <br>
</li>
<li><p>In the user settings sidebar, click <strong>SSH and GPG keys</strong>:</p>
  <br>
<a class="reference internal image-reference" href="../_images/ssh2.png"><img alt="../_images/ssh2.png" class="align-center" src="../_images/ssh2.png" style="width: 240px;" />
</a>
  <br>
</li>
<li><p>Click <strong>New SSH key</strong>:
<br></p>
<a class="reference internal image-reference" href="../_images/ssh3.png"><img alt="../_images/ssh3.png" class="align-center" src="../_images/ssh3.png" style="width: 640px;" />
</a>
  <br>
<p>In the <code class="docutils literal notranslate"><span class="pre">Title</span></code> field, add a descriptive label for the new key, such as ‚Äúrobot0‚Äù. Paste your key into the <code class="docutils literal notranslate"><span class="pre">Key</span></code> field (contents of the <code class="docutils literal notranslate"><span class="pre">.pub</span></code> file). Click <strong>Add SSH key</strong>.</p>
</li>
</ul>
</section>
<section id="optional-updates">
<h2>Optional Updates<a class="headerlink" href="#optional-updates" title="Link to this heading">#</a></h2>
<section id="update-alternatives">
<h3>Update Alternatives<a class="headerlink" href="#update-alternatives" title="Link to this heading">#</a></h3>
<p>Python3 is installed in Ubuntu 22.04 by default. Some ROS packages utilize the ‚Äúpython‚Äù command instead of ‚Äúpython3‚Äù so we need to create a new executable, ‚Äú/usr/bin/python‚Äù that will call the Python3 (basically use the command ‚Äúpython‚Äù to call Python3):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>update-alternatives<span class="w"> </span>--install<span class="w"> </span>/usr/bin/python<span class="w"> </span>python<span class="w"> </span>/usr/bin/python3<span class="w"> </span><span class="m">10</span>
</pre></div>
</div>
</section>
<section id="ece387-curriculum">
<h3><a class="reference external" href="https://github.com/AF-ROBOTICS/ece387_curriculum">ECE387 Curriculum</a><a class="headerlink" href="#ece387-curriculum" title="Link to this heading">#</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>clone<span class="w"> </span>git@github.com:AF-ROBOTICS/ece387_curriculum.git
</pre></div>
</div>
<p>The <strong>ece387_curriculum</strong> package includes all dependencies needed to run the TurtleBot3 nodes. We can automatically install these dependencies using the ROSDEP tool:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>~/robot_ws
rosdep<span class="w"> </span>install<span class="w"> </span>--from-paths<span class="w"> </span>src<span class="w"> </span>--ignore-src<span class="w"> </span>-r<span class="w"> </span>-y
</pre></div>
</div>
<p>This will take a while.</p>
<p>Now we can make and source our workspace:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>~/robot_ws
catkin_make
<span class="nb">source</span><span class="w"> </span>~/.bashrc
</pre></div>
</div>
<p>The last set of dependencies we need to install are Python dependencies. These are listed within our <strong>ece387_curriculum</strong> package and can be installed using the <code class="docutils literal notranslate"><span class="pre">pip3</span></code> tool:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>roscd<span class="w"> </span>ece387_curriculum
pip3<span class="w"> </span>install<span class="w"> </span>-r<span class="w"> </span>requirements.txt
</pre></div>
</div>
<blockquote>
<div><p>üìùÔ∏è <strong>Note:</strong> the ‚Äúdlib‚Äù package will take quite a while to install.</p>
</div></blockquote>
</section>
<section id="add-swap-space-optional">
<h3>Add Swap Space (optional)<a class="headerlink" href="#add-swap-space-optional" title="Link to this heading">#</a></h3>
<p>Since the Raspberry Pi 4B used in our course has 8 GB of RAM, Swap Space might not be necessary.</p>
<p>You can check that there is no active swap using the free utility:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pi@ubuntu:~$<span class="w"> </span>free<span class="w"> </span>-h
<span class="w">               </span>total<span class="w">        </span>used<span class="w">        </span>free<span class="w">      </span>shared<span class="w">  </span>buff/cache<span class="w">   </span>available
Mem:<span class="w">           </span><span class="m">7</span>.6Gi<span class="w">       </span>201Mi<span class="w">       </span><span class="m">7</span>.1Gi<span class="w">       </span><span class="m">3</span>.0Mi<span class="w">       </span>328Mi<span class="w">       </span><span class="m">7</span>.3Gi
Swap:<span class="w">             </span>0B<span class="w">          </span>0B<span class="w">          </span>0B
</pre></div>
</div>
<p>The <strong>fallocate</strong> program can be used to create a swap:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>fallocate<span class="w"> </span>-l<span class="w"> </span>2G<span class="w"> </span>/swapfile
</pre></div>
</div>
<p>If it was created correctly, you should see the below:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pi@ubuntu:~$<span class="w"> </span>ls<span class="w"> </span>-lh<span class="w"> </span>/swapfile
-rw-------<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">2</span>.0G<span class="w"> </span>Aug<span class="w"> </span><span class="m">19</span><span class="w"> </span><span class="m">17</span>:30<span class="w"> </span>/swapfile
</pre></div>
</div>
<p>Make the file only accessible to root by typing:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>chmod<span class="w"> </span><span class="m">600</span><span class="w"> </span>/swapfile
</pre></div>
</div>
<p>Verify the permissions by typing the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pi@ubuntu:~$<span class="w"> </span>ls<span class="w"> </span>-lh<span class="w"> </span>/swapfile<span class="w"> </span>
-rw-------<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">2</span>.0G<span class="w"> </span>Aug<span class="w"> </span><span class="m">19</span><span class="w"> </span><span class="m">17</span>:28<span class="w"> </span>/swapfile
Now<span class="w"> </span>only<span class="w"> </span>root<span class="w"> </span>user<span class="w"> </span>has<span class="w"> </span><span class="nb">read</span><span class="w"> </span>and<span class="w"> </span>write<span class="w"> </span>flags<span class="w"> </span>enabled.
</pre></div>
</div>
<p>You can set the file as swap space by typing the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pi@ubuntu:~$<span class="w"> </span>sudo<span class="w"> </span>mkswap<span class="w"> </span>/swapfile
Setting<span class="w"> </span>up<span class="w"> </span>swapspace<span class="w"> </span>version<span class="w"> </span><span class="m">1</span>,<span class="w"> </span><span class="nv">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="w"> </span>GiB<span class="w"> </span><span class="o">(</span><span class="m">2147479552</span><span class="w"> </span>bytes<span class="o">)</span>
no<span class="w"> </span>label,<span class="w"> </span><span class="nv">UUID</span><span class="o">=</span>b5bc4abf-2bce-419e-870d-4d44a7a05778
</pre></div>
</div>
<p>Then turn on the swap file:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>swapon<span class="w"> </span>/swapfile
</pre></div>
</div>
<p>To verify that this worked you can type the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pi@ubuntu:~$<span class="w"> </span>sudo<span class="w"> </span>swapon<span class="w"> </span>--show
NAME<span class="w">      </span>TYPE<span class="w"> </span>SIZE<span class="w"> </span>USED<span class="w"> </span>PRIO
/swapfile<span class="w"> </span>file<span class="w">   </span>2G<span class="w">   </span>0B<span class="w">   </span>-2
</pre></div>
</div>
<p>This swap will only last until reboot, so to make it permanent at it to the <code class="docutils literal notranslate"><span class="pre">fstab</span></code> file:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;/swapfile none swap sw 0 0&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>-a<span class="w"> </span>/etc/fstab
</pre></div>
</div>
<p>Now it is time to reboot by typing</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>reboot
</pre></div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Appendix"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../Labs/FinalProject.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">üöÄ Final Project</p>
      </div>
    </a>
    <a class="right-next"
       href="MasterSetup.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">üîß Master Setup</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#turtlebot3">TurtleBot3</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hardware-assembly">Hardware Assembly</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#raspberry-pi">Raspberry Pi</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#camera">Camera</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ubuntu-installation">Ubuntu Installation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-ubuntu-and-flash-microsd-card">Download Ubuntu and flash MicroSD card</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#configuring-ubuntu">Configuring Ubuntu</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#login-and-changing-password">Login and changing password</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-username">Adding username</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#change-hostname">Change hostname</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#set-up-wi-fi-optional">Set up Wi-Fi (Optional)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#static-ip-address-optional">Static IP Address (Optional)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#disable-automatic-updates">Disable Automatic Updates</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#verify-changes">Verify changes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#update-and-upgrade">Update and Upgrade</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#install-ubuntu-desktop-optional">Install Ubuntu Desktop (optional)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#install-rtl8723bu-driver-ubuntu-22-04">Install RTL8723BU driver (Ubuntu 22.04)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dual-wi-fi-setup-client-access-point">Dual Wi-Fi Setup (Client + Access Point)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#goal-final-architecture">GOAL (Final Architecture)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#verify-interfaces">Verify Interfaces</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#configure-wi-fi-client-internet-wlan1">Configure Wi-Fi Client (Internet) ‚Äî <code class="docutils literal notranslate"><span class="pre">wlan1</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#configure-static-ip-for-access-point-wlan0">Configure Static IP for Access Point ‚Äî <code class="docutils literal notranslate"><span class="pre">wlan0</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#configure-dhcp-for-ap-clients-dnsmasq">Configure DHCP for AP Clients (dnsmasq)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-controls-the-ap-instead">What controls the AP instead</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hostapd-configuration-template">Hostapd Configuration Template</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#systemd-service-for-automatic-ssid-update">Systemd Service for Automatic SSID Update</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#disable-cloud-init-hostname-reset-important">Disable cloud-init Hostname Reset (IMPORTANT)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#final-verification">Final Verification</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ros2-humble">ROS2 Humble</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#installation">Installation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#configuring-ros2-environment">Configuring ROS2 Environment</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#install-and-build-ros2-packages">Install and Build ROS2 Packages</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#usb-port-setting-for-opencr">USB Port Setting for OpenCR</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lds-configuration">LDS Configuration</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#install-software-for-ece-387">Install software for ECE 387</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#camera-permissions">Camera Permissions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#updating-opencr-firmware">Updating OpenCR firmware</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setup-github-ssh-keys">Setup GitHub SSH Keys</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#optional-updates">Optional Updates</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#update-alternatives">Update Alternatives</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ece387-curriculum">ECE387 Curriculum</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#add-swap-space-optional">Add Swap Space (optional)</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Stan Baek
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>