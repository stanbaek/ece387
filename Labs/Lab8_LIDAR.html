
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>üî¨ Lab 8: LiDAR &#8212; Introduction to Robotic Systems</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css?v=4c969af8" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="../_static/tabs.js?v=3ee01567"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Labs/Lab8_LIDAR';</script>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="üî¨ Lab9: SLAM" href="Lab9_SLAM.html" />
    <link rel="prev" title="üî¨ Lab7: Transformation" href="Lab7_TF.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/ece387.png" class="logo__image only-light" alt="Introduction to Robotic Systems - Home"/>
    <img src="../_static/ece387.png" class="logo__image only-dark pst-js-only" alt="Introduction to Robotic Systems - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    ECE 387 Introduction to Robotic Systems
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Course Info</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../syllabus.html">üìå Syllabus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../schedule.html">üìÜ Course Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PythonBasic.html">üêç Python Basic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PythonIntermediate.html">üêç Python Intermediate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../NumPy.html">‚ûï NumPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">üôã FAQ</a></li>
<li class="toctree-l1"><a class="reference external" href="https://stanbaek.github.io/NoPointer.html">No Pointers in Python?</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Labs</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Lab1_Linux.html">üî¨ Lab1: Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lab2_ROS.html">üî¨ Lab2: ROS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lab3_Python.html">üî¨ Lab3: Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lab4_Gamepad.html">üî¨ Lab4: Gamepad</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lab5_TurtleBot.html">üî¨ Lab5: Driving the Robot</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lab6_IMU.html">üî¨ Lab6: IMU-Based Navigation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lab7_TF.html">üî¨ Lab7: Transformation</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">üî¨ Lab 8: LiDAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lab9_SLAM.html">üî¨ Lab9: SLAM</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lab10_CV.html">üî¨ Lab10: CV</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lab11_AprilTag.html">üî¨ Lab11: AprilTag</a></li>
<li class="toctree-l1"><a class="reference internal" href="FinalProject.html">üöÄ Final Project</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Appendix/RobotSetup.html">üîß Robot Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Appendix/MasterSetup.html">üîß Master Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Appendix/GitSetup.html">üîß Git Repo Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Appendix/GamepadSetup.html">üîß Gamepad Setup</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/stanbaek/ece387" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/stanbaek/ece387/issues/new?title=Issue%20on%20page%20%2FLabs/Lab8_LIDAR.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Labs/Lab8_LIDAR.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>üî¨ Lab 8: LiDAR</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#objectives">üìå Objectives</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">üìú Overview</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-lidar-works">üìπ How LiDAR Works</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#turtlebot3-lidar-example">üìπ TurtleBot3 LiDAR Example</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pre-lab-setting-up-and-testing-lidar">üå± Pre-Lab: Setting Up and Testing LiDAR</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-ros2-launch-files">Using ROS2 Launch Files</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#install-packages">Install Packages</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lab-procedure-lidar-based-wall-detection">üíª Lab Procedure: LiDAR-Based Wall Detection</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-up-your-ros2-package">Setting Up Your ROS2 Package</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#implementing-the-python-scripts">Implementing the Python Scripts</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#running-the-simulation"><strong>Running the Simulation</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#running-the-real-robot">Running the Real Robot</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deliverables">üöö Deliverables</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="lab-8-lidar">
<h1>üî¨ Lab 8: LiDAR<a class="headerlink" href="#lab-8-lidar" title="Link to this heading">#</a></h1>
<section id="objectives">
<h2>üìå Objectives<a class="headerlink" href="#objectives" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Students should be able to implement a ROS2 node to detect walls using LiDAR data.</p></li>
<li><p>Students should be able to visualize detected walls in RViz.</p></li>
<li><p>Students should be able to test their implementation using Gazebo.</p></li>
<li><p>Students should be able to use ROS2 launch files to manage multiple nodes efficiently.</p></li>
</ul>
</section>
<section id="overview">
<h2>üìú Overview<a class="headerlink" href="#overview" title="Link to this heading">#</a></h2>
<p>In this lab, we‚Äôll enable our robot to detect and follow walls using LiDAR. While various sensors like cameras, sonar, and infrared can detect objects, we‚Äôll focus on LiDAR due to its affordability and effectiveness.</p>
<p>The <a class="reference external" href="https://www.robotis.us/360-laser-distance-sensor-lds-01-lidar/">Robotis LDS-01 LiDAR</a> is a 360-degree Laser Distance Sensor (LDS) that measures distances over 1,800 times per second. It has a range of 0.12m to 3.5m with an angular resolution of 1 degree and an accuracy of <span class="math notranslate nohighlight">\(\pm\)</span>0.015m for close distances, increasing to <span class="math notranslate nohighlight">\(\pm\)</span>5% beyond 0.5m.</p>
<a class="reference internal image-reference" href="../_images/rplidar.png"><img alt="../_images/rplidar.png" class="align-center" src="../_images/rplidar.png" style="width: 300px;" /></a>
<section id="how-lidar-works">
<h3>üìπ How LiDAR Works<a class="headerlink" href="#how-lidar-works" title="Link to this heading">#</a></h3>
<center>
<iframe width="560" height="315" src="https://www.youtube.com/embed/EYbhNSUnIdU?si=idFVZOttywfaJ_Ys" title="YouTube video player" frameborder="0" allowfullscreen></iframe>
</center>
</section>
<section id="turtlebot3-lidar-example">
<h3>üìπ TurtleBot3 LiDAR Example<a class="headerlink" href="#turtlebot3-lidar-example" title="Link to this heading">#</a></h3>
<center>
<iframe width="560" height="315" src="https://www.youtube.com/embed/9oic8aT3wIc?si=nedLzJ4oj7beh2Xk" title="YouTube video player" frameborder="0" allowfullscreen></iframe>
</center>
</section>
</section>
<section id="pre-lab-setting-up-and-testing-lidar">
<h2>üå± Pre-Lab: Setting Up and Testing LiDAR<a class="headerlink" href="#pre-lab-setting-up-and-testing-lidar" title="Link to this heading">#</a></h2>
<p>Before we dive into wall detection, we need to ensure that our setup is working correctly.</p>
<section id="using-ros2-launch-files">
<span id="lidar-launch"></span><h3>Using ROS2 Launch Files<a class="headerlink" href="#using-ros2-launch-files" title="Link to this heading">#</a></h3>
<p>Managing multiple ROS nodes can become overwhelming, especially as our system grows. Instead of running each node in separate terminals, we‚Äôll use ROS2 launch files to simplify the process.</p>
<ol class="arabic">
<li><p><strong>Navigate to Your Package</strong>: Open a terminal and move to the <code class="docutils literal notranslate"><span class="pre">lab4_gamepad</span></code> package.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>~/master_ws/src/ece387_ws/lab4_gamepad
</pre></div>
</div>
</li>
<li><p><strong>Create a Launch Directory</strong>: Create a <code class="docutils literal notranslate"><span class="pre">launch</span></code> directory:</p></li>
<li><p><strong>Create a Launch File</strong>: Inside the <code class="docutils literal notranslate"><span class="pre">launch</span></code> directory, create a new file named <code class="docutils literal notranslate"><span class="pre">gamepad.launch.py</span></code>:</p></li>
<li><p><strong>Open the File in VS Code</strong>: Open the newly created file in your code editor.</p></li>
<li><p><strong>Copy and Paste the Following Code</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">launch</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">launch_ros.actions</span>

<span class="k">def</span><span class="w"> </span><span class="nf">generate_launch_description</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Launches the gamepad node from lab4_gamepad</span>
<span class="sd">    and the joy_node from the joy package.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">launch</span><span class="o">.</span><span class="n">LaunchDescription</span><span class="p">([</span>
        <span class="n">launch_ros</span><span class="o">.</span><span class="n">actions</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span>
            <span class="n">package</span><span class="o">=</span><span class="s1">&#39;joy&#39;</span><span class="p">,</span>
            <span class="n">executable</span><span class="o">=</span><span class="s1">&#39;joy_node&#39;</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;joy_node&#39;</span><span class="p">,</span>
            <span class="n">output</span><span class="o">=</span><span class="s1">&#39;screen&#39;</span>
        <span class="p">),</span>
        <span class="n">launch_ros</span><span class="o">.</span><span class="n">actions</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span>
            <span class="n">package</span><span class="o">=</span><span class="s1">&#39;lab4_gamepad&#39;</span><span class="p">,</span>
            <span class="n">executable</span><span class="o">=</span><span class="s1">&#39;gamepad&#39;</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;gamepad_node&#39;</span><span class="p">,</span>
            <span class="n">output</span><span class="o">=</span><span class="s1">&#39;screen&#39;</span>
        <span class="p">),</span>
    <span class="p">])</span>
</pre></div>
</div>
</li>
<li><p><strong>Modify <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> to Include the Launch File</strong>: Open <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> and add:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">glob</span><span class="w"> </span><span class="kn">import</span> <span class="n">glob</span>
</pre></div>
</div>
<p>Then, add this line inside <code class="docutils literal notranslate"><span class="pre">data_files</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;share&#39;</span><span class="p">,</span> <span class="n">package_name</span><span class="p">,</span> <span class="s1">&#39;launch&#39;</span><span class="p">),</span> <span class="n">glob</span><span class="p">(</span><span class="s1">&#39;launch/*.launch.py&#39;</span><span class="p">)),</span>
</pre></div>
</div>
</li>
<li><p><strong>Update <code class="docutils literal notranslate"><span class="pre">package.xml</span></code></strong>: Ensure the dependencies include:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;depend&gt;</span>launch<span class="nt">&lt;/depend&gt;</span>
<span class="nt">&lt;depend&gt;</span>launch_ros<span class="nt">&lt;/depend&gt;</span>
</pre></div>
</div>
</li>
<li><p><strong>Build the Package</strong>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ccbuild<span class="w"> </span>--packages-select<span class="w"> </span>lab4_gamepad
</pre></div>
</div>
</li>
<li><p><strong>Run the Launch File</strong>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>launch<span class="w"> </span>lab4_gamepad<span class="w"> </span>gamepad.1aunch.py
</pre></div>
</div>
</li>
<li><p><strong>Verify Nodes Are Running</strong>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>node<span class="w"> </span>list
</pre></div>
</div>
<p>You should see <code class="docutils literal notranslate"><span class="pre">gamepad_node</span></code> and <code class="docutils literal notranslate"><span class="pre">joy_node</span></code> listed.</p>
</li>
</ol>
</section>
<section id="install-packages">
<h3>Install Packages<a class="headerlink" href="#install-packages" title="Link to this heading">#</a></h3>
<ol class="arabic">
<li><p>Use the following command to install the <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code> machine learning package for Python:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>scikit-learn
</pre></div>
</div>
</li>
<li><p>Download the <a class="reference download internal" download="" href="../_downloads/2844754c6fc74165cb2a5da1b8af483b/squarepath_gazebo.tar.xz"><span class="xref download myst"><code class="docutils literal notranslate"><span class="pre">square</span> <span class="pre">path</span> <span class="pre">Gazebo</span> <span class="pre">files</span></code></span></a>. Extract the files and move them inside the appropriate directories in <code class="docutils literal notranslate"><span class="pre">~/master_ws/src/turtlebot3_simulations/turtlebot3_gazebo</span></code>. Ensure each new directory is moved to the existing directory with the same name.</p></li>
<li><p>Return to the ROS2 workspace root and build the package or simply run <code class="docutils literal notranslate"><span class="pre">ccbuild</span></code>.</p></li>
<li><p>Open the Gazebo simulation:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>launch<span class="w"> </span>turtlebot3_gazebo<span class="w"> </span>square_path.launch.py
</pre></div>
</div>
<p>It will open the Gazebo simulation as shown in the figure below.</p>
<a class="reference internal image-reference" href="../_images/Lab8_SquarePathGazebo.png"><img alt="../_images/Lab8_SquarePathGazebo.png" class="align-center" src="../_images/Lab8_SquarePathGazebo.png" style="width: 500px;" /></a>
</li>
<li><p>Type the following and observe the command output:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>topic<span class="w"> </span>list
ros2<span class="w"> </span>topic<span class="w"> </span>info<span class="w"> </span>/scan
ros2<span class="w"> </span>topic<span class="w"> </span><span class="nb">echo</span><span class="w"> </span>/scan
</pre></div>
</div>
</li>
<li><p>Find the message type of the <code class="docutils literal notranslate"><span class="pre">/scan</span></code> topic:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>topic<span class="w"> </span><span class="nb">type</span><span class="w"> </span>/scan
</pre></div>
</div>
<p>Then, examine the details of the message type.</p>
</li>
<li><p>Open the RViz visualization tool:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>launch<span class="w"> </span>turtlebot3_bringup<span class="w"> </span>rviz.launch.py
</pre></div>
</div>
<p>This should open an RViz window where we can visualize ROS components of our system. In the <code class="docutils literal notranslate"><span class="pre">Displays</span></code> menu on the left, you should see two submenus of interest: <code class="docutils literal notranslate"><span class="pre">LaserScan</span></code> and <code class="docutils literal notranslate"><span class="pre">RobotModel</span></code>. These allow us to depict the TurtleBot3 and LiDAR data. You should see red dots fill the <strong>rviz</strong> map where obstacles exist, as shown below.</p>
<a class="reference internal image-reference" href="../_images/Lab8_SquarePathRViz.png"><img alt="../_images/Lab8_SquarePathRViz.png" class="align-center" src="../_images/Lab8_SquarePathRViz.png" style="width: 500px;" /></a>
</li>
</ol>
</section>
</section>
<section id="lab-procedure-lidar-based-wall-detection">
<h2>üíª Lab Procedure: LiDAR-Based Wall Detection<a class="headerlink" href="#lab-procedure-lidar-based-wall-detection" title="Link to this heading">#</a></h2>
<p>Follow the steps below to set up your ROS 2 package, implement the required scripts, and run the simulation or real robot.</p>
<section id="setting-up-your-ros2-package">
<h3>Setting Up Your ROS2 Package<a class="headerlink" href="#setting-up-your-ros2-package" title="Link to this heading">#</a></h3>
<ol class="arabic">
<li><p><strong>Navigate to Your Workspace:</strong> Open a terminal and move into your ROS 2 workspace directory:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>~/master_ws/src/ece387_ws
</pre></div>
</div>
</li>
<li><p><strong>Create a New ROS2 Package:</strong> Create a new package named <code class="docutils literal notranslate"><span class="pre">lab8_lidar</span></code> with the BSD-3 license:</p></li>
<li><p><strong>Add Dependencies:</strong> Edit <code class="docutils literal notranslate"><span class="pre">package.xml</span></code> to include the following dependencies:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;depend&gt;</span>rclpy<span class="nt">&lt;/depend&gt;</span>
<span class="nt">&lt;depend&gt;</span>sensor_msgs<span class="nt">&lt;/depend&gt;</span>
<span class="nt">&lt;depend&gt;</span>geometry_msgs<span class="nt">&lt;/depend&gt;</span>
<span class="nt">&lt;depend&gt;</span>nav2_msgs<span class="nt">&lt;/depend&gt;</span>
<span class="nt">&lt;depend&gt;</span>tf2_ros<span class="nt">&lt;/depend&gt;</span>
<span class="nt">&lt;depend&gt;</span>visualization_msgs<span class="nt">&lt;/depend&gt;</span>
<span class="nt">&lt;depend&gt;</span>numpy<span class="nt">&lt;/depend&gt;</span>
<span class="nt">&lt;depend&gt;</span>scikit-learn<span class="nt">&lt;/depend&gt;</span>
</pre></div>
</div>
</li>
<li><p><strong>Download Required Scripts</strong>: Download the following scripts and save them in the <code class="docutils literal notranslate"><span class="pre">lab8_lidar/lab8_lidar</span></code> directory:</p>
<ul class="simple">
<li><p><a class="reference download internal" download="" href="../_downloads/2150b18d25e96d634619e033fe30e3d3/wall_detector.py"><span class="xref download myst"><code class="docutils literal notranslate"><span class="pre">wall_detector.py</span></code></span></a></p></li>
<li><p><a class="reference download internal" download="" href="../_downloads/2bf3abb8e545a250ac7044c57c002cea/line_follower.py"><span class="xref download myst"><code class="docutils literal notranslate"><span class="pre">line_follower.py</span></code></span></a></p></li>
</ul>
</li>
<li><p><strong>Modify <code class="docutils literal notranslate"><span class="pre">setup.py</span></code></strong>: Add your scripts under <code class="docutils literal notranslate"><span class="pre">entry_points</span></code>.</p></li>
</ol>
</section>
<section id="implementing-the-python-scripts">
<h3>Implementing the Python Scripts<a class="headerlink" href="#implementing-the-python-scripts" title="Link to this heading">#</a></h3>
<ol class="arabic">
<li><p><strong>Complete <code class="docutils literal notranslate"><span class="pre">wall_detector.py</span></code></strong><br />
Open the <code class="docutils literal notranslate"><span class="pre">wall_detector.py</span></code> script and implement the missing functionality as described in the comments. This script will process LiDAR data to detect walls and publish visualization markers.</p></li>
<li><p><strong>Complete <code class="docutils literal notranslate"><span class="pre">line_follower.py</span></code></strong><br />
Open the <code class="docutils literal notranslate"><span class="pre">line_follower.py</span></code> script and implement the missing functionality as described in the comments. This script will enable the robot to follow the detected center line between walls.</p></li>
<li><p><strong>Build the Package</strong><br />
After completing the scripts, build the package:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ccbuild<span class="w"> </span>--packages-select<span class="w"> </span>lab8_lidar
</pre></div>
</div>
</li>
</ol>
</section>
<section id="running-the-simulation">
<h3><strong>Running the Simulation</strong><a class="headerlink" href="#running-the-simulation" title="Link to this heading">#</a></h3>
<ol class="arabic">
<li><p><strong>Launch Gazebo with TurtleBot3</strong> Start the Gazebo simulation with the TurtleBot3 robot:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>launch<span class="w"> </span>turtlebot3_gazebo<span class="w"> </span>square_path.launch.py
</pre></div>
</div>
</li>
<li><p><strong>Open RViz for Visualization</strong> Launch RViz to visualize the detected walls and determine the center line:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>launch<span class="w"> </span>turtlebot3_bringup<span class="w"> </span>rviz.launch.py
</pre></div>
</div>
</li>
<li><p><strong>Run the Wall Detector Node</strong>  Start the wall detection node:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>run<span class="w"> </span>lab8_lidar<span class="w"> </span>wall_detector
</pre></div>
</div>
</li>
<li><p><strong>Observe the Detected Walls in RViz</strong></p>
<ul class="simple">
<li><p>Unselect <code class="docutils literal notranslate"><span class="pre">TF</span></code> and <code class="docutils literal notranslate"><span class="pre">Odometry</span></code> in RViz.</p></li>
<li><p>Click the <code class="docutils literal notranslate"><span class="pre">Add</span></code> button in the bottom left of the RViz window, select the <code class="docutils literal notranslate"><span class="pre">By</span> <span class="pre">topic</span></code> tab, and add the <code class="docutils literal notranslate"><span class="pre">Marker</span></code> messages under the <code class="docutils literal notranslate"><span class="pre">/center_line</span></code> and <code class="docutils literal notranslate"><span class="pre">/wall_markers</span></code> topics.</p></li>
</ul>
</li>
<li><p><strong>Debug If Needed</strong> If you encounter issues, run the wall detector node in debug mode:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>run<span class="w"> </span>lab8lidar<span class="w"> </span>wall_detector<span class="w"> </span>--ros-args<span class="w"> </span>--log-level<span class="w"> </span>debug
</pre></div>
</div>
</li>
<li><p><strong>Update Parameters</strong> Adjust the parameters for the <code class="docutils literal notranslate"><span class="pre">DBSCAN</span></code> clustering function and the <code class="docutils literal notranslate"><span class="pre">RANSACRegressor</span></code> function to improve wall detection.</p></li>
<li><p><strong>Run the Line Follower Node</strong> Once the center line is detected, start the line follower node:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>run<span class="w"> </span>lab8_lidar<span class="w"> </span>line_follower
</pre></div>
</div>
<p>Ensure you also launch <code class="docutils literal notranslate"><span class="pre">gamepad.launch.py</span></code> to relinquish control.</p>
</li>
<li><p><strong>Tune the Controller Gains</strong><br />
Adjust the <code class="docutils literal notranslate"><span class="pre">kh</span></code> (heading gain) and <code class="docutils literal notranslate"><span class="pre">kd</span></code> (distance gain) values in the <code class="docutils literal notranslate"><span class="pre">line_follower.py</span></code> script to optimize the robot‚Äôs line-following performance.</p></li>
</ol>
</section>
<section id="running-the-real-robot">
<h3>Running the Real Robot<a class="headerlink" href="#running-the-real-robot" title="Link to this heading">#</a></h3>
<ol class="arabic">
<li><p><strong>Close the Gazebo Simulation</strong> Ensure the Gazebo simulation is closed before running the real robot. Never run the simulation and the real robot simultaneously.</p></li>
<li><p><strong>Reopen RViz</strong> Launch RViz to visualize the wall detection on the real robot:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>launch<span class="w"> </span>turtlebot3_bringup<span class="w"> </span>rviz.launch.py
</pre></div>
</div>
</li>
<li><p><strong>Run the Wall Detector Node</strong> Start the wall detection node:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>run<span class="w"> </span>lab8lidar<span class="w"> </span>wall_detector
</pre></div>
</div>
</li>
<li><p><strong>Fix QoS Warning</strong> If you see the following warning:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>WARN<span class="o">]</span><span class="w"> </span><span class="o">[</span>wall_detector<span class="o">]</span>:<span class="w"> </span>New<span class="w"> </span>publisher<span class="w"> </span>discovered<span class="w"> </span>on<span class="w"> </span>topic<span class="w"> </span><span class="s1">&#39;/scan&#39;</span>,<span class="w"> </span>offering<span class="w"> </span>incompatible<span class="w"> </span>QoS.<span class="w"> </span>No<span class="w"> </span>messages<span class="w"> </span>will<span class="w"> </span>be<span class="w"> </span>received<span class="w"> </span>from<span class="w"> </span>it.<span class="w"> </span>Last<span class="w"> </span>incompatible<span class="w"> </span>policy:<span class="w"> </span>RELIABILITY
</pre></div>
</div>
<p>Investigate the warning and fix it using the <code class="docutils literal notranslate"><span class="pre">qos_profile</span></code> provided in the <code class="docutils literal notranslate"><span class="pre">wall_detector.py</span></code> script. You can use Google or ChatGPT to learn more about ROS 2 QoS (Quality of Service).</p>
</li>
<li><p><strong>Run the Line Follower Node</strong> Start the line follower node:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>run<span class="w"> </span>lab8_lidar<span class="w"> </span>line_follower
</pre></div>
</div>
</li>
<li><p><strong>Demo the Robot</strong> Demonstrate the robot following the walls in a straight path. <strong>Ensure the robot starts 10 cm from the center line as shown below.</strong></p></li>
</ol>
<center>
<iframe width="560" height="315" src="https://www.youtube.com/embed/yf1iLbKwU3E?si=f9wdUHjrpu-KqkSU" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
</center>
</section>
</section>
<section id="deliverables">
<h2>üöö Deliverables<a class="headerlink" href="#deliverables" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><strong>[20 Points] Complete the <code class="docutils literal notranslate"><span class="pre">wall_detector.py</span></code> Script</strong></p>
<ul class="simple">
<li><p>Ensure the script is fully functional and implements all required features.</p></li>
<li><p>Push your code to GitHub and confirm that it has been successfully uploaded.
<strong>NOTE:</strong> <em>If the instructor can‚Äôt find your code in your repository, you will receive a grade of 0 for the coding part.</em></p></li>
</ul>
</li>
<li><p><strong>[15 Points] Complete the <code class="docutils literal notranslate"><span class="pre">line_follower.py</span></code> Script</strong></p>
<ul class="simple">
<li><p>Ensure the script is fully functional and implements all required features.</p></li>
<li><p>Push your code to GitHub and confirm that it has been successfully uploaded.
<strong>NOTE:</strong> <em>If the instructor can‚Äôt find your code in your repository, you will receive a grade of 0 for the coding part.</em></p></li>
</ul>
</li>
<li><p><strong>[15 Points] Demonstration</strong></p>
<ul class="simple">
<li><p>Show the robot successfully move between two walls.</p></li>
</ul>
</li>
</ol>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Labs"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Lab7_TF.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">üî¨ Lab7: Transformation</p>
      </div>
    </a>
    <a class="right-next"
       href="Lab9_SLAM.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">üî¨ Lab9: SLAM</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#objectives">üìå Objectives</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">üìú Overview</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-lidar-works">üìπ How LiDAR Works</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#turtlebot3-lidar-example">üìπ TurtleBot3 LiDAR Example</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pre-lab-setting-up-and-testing-lidar">üå± Pre-Lab: Setting Up and Testing LiDAR</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-ros2-launch-files">Using ROS2 Launch Files</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#install-packages">Install Packages</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lab-procedure-lidar-based-wall-detection">üíª Lab Procedure: LiDAR-Based Wall Detection</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-up-your-ros2-package">Setting Up Your ROS2 Package</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#implementing-the-python-scripts">Implementing the Python Scripts</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#running-the-simulation"><strong>Running the Simulation</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#running-the-real-robot">Running the Real Robot</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deliverables">üöö Deliverables</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Stan Baek
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>