
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>üî¨ Lab9: SLAM &#8212; Introduction to Robotic Systems</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css?v=4c969af8" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="../_static/tabs.js?v=3ee01567"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Labs/Lab9_SLAM';</script>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="üî¨ Lab10: CV" href="Lab10_CV.html" />
    <link rel="prev" title="üî¨ Lab 8: LiDAR" href="Lab8_LIDAR.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/ece387.png" class="logo__image only-light" alt="Introduction to Robotic Systems - Home"/>
    <img src="../_static/ece387.png" class="logo__image only-dark pst-js-only" alt="Introduction to Robotic Systems - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    ECE 387 Introduction to Robotic Systems
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Course Info</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../syllabus.html">üìå Syllabus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../schedule.html">üìÜ Course Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PythonBasic.html">üêç Python Basic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PythonIntermediate.html">üêç Python Intermediate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../NumPy.html">‚ûï NumPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">üôã FAQ</a></li>
<li class="toctree-l1"><a class="reference external" href="https://stanbaek.github.io/NoPointer.html">No Pointers in Python?</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Labs</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Lab1_Linux.html">üî¨ Lab1: Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lab2_ROS.html">üî¨ Lab2: ROS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lab3_Python.html">üî¨ Lab3: Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lab4_Gamepad.html">üî¨ Lab4: Gamepad</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lab5_TurtleBot.html">üî¨ Lab5: Driving the Robot</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lab6_IMU.html">üî¨ Lab6: IMU-Based Navigation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lab7_TF.html">üî¨ Lab7: Transformation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lab8_LIDAR.html">üî¨ Lab 8: LiDAR</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">üî¨ Lab9: SLAM</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lab10_CV.html">üî¨ Lab10: CV</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lab11_AprilTag.html">üî¨ Lab11: AprilTag</a></li>
<li class="toctree-l1"><a class="reference internal" href="FinalProject.html">üöÄ Final Project</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Appendix/RobotSetup.html">üîß Robot Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Appendix/MasterSetup.html">üîß Master Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Appendix/GitSetup.html">üîß Git Repo Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Appendix/GamepadSetup.html">üîß Gamepad Setup</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/stanbaek/ece387" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/stanbaek/ece387/issues/new?title=Issue%20on%20page%20%2FLabs/Lab9_SLAM.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Labs/Lab9_SLAM.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>üî¨ Lab9: SLAM</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#objectives">üìå Objectives</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">üìú Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pre-lab-ros2-client-libraries">üå± Pre-Lab: ROS2 Client Libraries</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lab-procedures">üõ†Ô∏è Lab Procedures</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-up-turtlebot3-with-slam-in-gazebo"><strong>1. Setting Up TurtleBot3 with SLAM in Gazebo</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#navigation-with-slam"><strong>2. Navigation with SLAM</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#autonomous-navigation-with-slam-in-gazebo"><strong>3. Autonomous Navigation with SLAM in Gazebo</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#autonomous-navigation-with-prebuilt-map-in-gazebo"><strong>4. Autonomous Navigation with Prebuilt Map in Gazebo</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#optional-autonomous-navigation-with-cartographer-turtlebot3-real-environment"><strong>5. (Optional) Autonomous Navigation with Cartographer (TurtleBot3, Real Environment)</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#optional-autonomous-navigation-with-prebuilt-map-turtlebot3-real-environment"><strong>6. (Optional) Autonomous Navigation with Prebuilt Map (TurtleBot3, Real Environment)</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deliverables">üöö Deliverables</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="lab9-slam">
<h1>üî¨ Lab9: SLAM<a class="headerlink" href="#lab9-slam" title="Link to this heading">#</a></h1>
<section id="objectives">
<h2>üìå Objectives<a class="headerlink" href="#objectives" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Students should be able to implement a ROS2 node to detect walls using LiDAR data.</p></li>
<li><p>This lab focuses on simulating autonomous exploration and navigation using SLAM in both Gazebo and real-world TurtleBot3 environments. You‚Äôll work with a prebuilt map and create new maps using Cartographer.</p></li>
</ul>
</section>
<section id="overview">
<h2>üìú Overview<a class="headerlink" href="#overview" title="Link to this heading">#</a></h2>
<p>In this project, we will enable our robot to autonomously navigate an unknown maze and build a map of the environment. As in the previous lab, we will use LiDAR to detect the walls of the maze (or obstacles) surrounding the robot. We will be utilizing the Simultaneous Localization and Mapping (SLAM) library provided by ROS2 and TurtleBot3.</p>
<p>SLAM, or Simultaneous Localization and Mapping, is a process used in robotics to enable a robot to build a map of an unknown environment while simultaneously determining its location within that map. It involves combining sensor data, algorithms, and probabilistic methods to perform real-time mapping and localization. SLAM is crucial for autonomous robots to operate effectively in environments where pre-existing maps are not available.</p>
<p>SLAM is one of the fundamental algorithms in robotics and is widely used in applications such as autonomous vehicles, drone navigation, and robotic vacuum cleaners. It enables robots to navigate dynamic and unfamiliar environments without relying on GPS or pre-defined maps, which is essential for many real-world scenarios.</p>
<p>SLAM integrates data from sensors like LiDAR and odometry to construct and update a map while estimating the robot‚Äôs position. Through statistical methods like Kalman Filters or Particle Filters, SLAM corrects errors in localization and mapping to achieve accurate results. While the underlying mathematics involves advanced topics in statistics and optimization, libraries provided in ROS2 simplify SLAM‚Äôs implementation, making it accessible for practical applications.</p>
<p>We will use Cartographer in this lab because it provides an efficient and accurate SLAM solution for 2D environments like the maze we‚Äôll be mapping. Its ability to handle LiDAR data and update maps in real time makes it ideal for this project. Furthermore, its compatibility with TurtleBot3 and ROS2 simplifies the setup, allowing us to focus on understanding the SLAM process and its applications.</p>
</section>
<section id="pre-lab-ros2-client-libraries">
<h2>üå± Pre-Lab: ROS2 Client Libraries<a class="headerlink" href="#pre-lab-ros2-client-libraries" title="Link to this heading">#</a></h2>
<p>The <a class="reference external" href="https://docs.ros.org/en/humble/Tutorials/Intermediate.html">ROS2 Intermediate Tutorials</a> on <code class="docutils literal notranslate"><span class="pre">actions</span></code>  are a great starting point for learning about ROS2 action servers and clients.</p>
<a class="reference internal image-reference" href="../_images/Lab9_ROS2_ActionTutorials.png"><img alt="../_images/Lab9_ROS2_ActionTutorials.png" class="align-center" src="../_images/Lab9_ROS2_ActionTutorials.png" style="width: 800px;" /></a>
<br>  
<p>Complete the following three tutorials. <strong>Important:</strong> Skip <strong>C++</strong> tutorials and focus only on the <strong>Python</strong> tutorials.</p>
<ol class="arabic simple">
<li><p><strong>Managing Dependencies with rosdep</strong></p>
<ul class="simple">
<li><p>No need to install anything - your computer already has all the required packages set up.</p></li>
</ul>
</li>
<li><p><strong>Creating an action</strong></p>
<ul class="simple">
<li><p>Make sure you‚Äôre working in the <code class="docutils literal notranslate"><span class="pre">ros2_ws</span></code> workspace. Avoid using the <code class="docutils literal notranslate"><span class="pre">master_ws</span></code> workspace for this one.</p></li>
</ul>
</li>
<li><p><strong>Writing an action server and client (Python)</strong></p>
<ul class="simple">
<li><p>As instructed at the end of this tutorial, run the action client.  When the feedback appears on the screen, capture a screenshot and upload it to Gradescope.</p></li>
</ul>
</li>
</ol>
</section>
<section id="lab-procedures">
<h2>üõ†Ô∏è Lab Procedures<a class="headerlink" href="#lab-procedures" title="Link to this heading">#</a></h2>
<section id="setting-up-turtlebot3-with-slam-in-gazebo">
<h3><strong>1. Setting Up TurtleBot3 with SLAM in Gazebo</strong><a class="headerlink" href="#setting-up-turtlebot3-with-slam-in-gazebo" title="Link to this heading">#</a></h3>
<p>Follow these steps to simulate SLAM with TurtleBot3 in the Gazebo environment.</p>
<ol class="arabic">
<li><p>Download the <a class="reference download internal" download="" href="../_downloads/2f4f245279e8412cccea4a01cc4d1d76/maze.tar.xz"><span class="xref download myst"><code class="docutils literal notranslate"><span class="pre">maze</span> <span class="pre">Gazebo</span> <span class="pre">files</span></code></span></a>. Extract the files and place them in the appropriate directories within <code class="docutils literal notranslate"><span class="pre">~/master_ws/src/turtlebot3_simulations/turtlebot3_gazebo</span></code>. Make sure to merge the new directories with the existing ones.</p></li>
<li><p>Run the following command to start the Gazebo simulation with the maze world:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>launch<span class="w"> </span>turtlebot3_gazebo<span class="w"> </span>maze.launch.py
</pre></div>
</div>
<p>This will launch the Gazebo environment with the maze, as shown below:</p>
<a class="reference internal image-reference" href="../_images/Proj1_GazeboInit.png"><img alt="../_images/Proj1_GazeboInit.png" class="align-center" src="../_images/Proj1_GazeboInit.png" style="width: 400px;" /></a>
</li>
<li><p>Open a new terminal and start the Cartographer SLAM process:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>launch<span class="w"> </span>turtlebot3_cartographer<span class="w"> </span>cartographer.launch.py<span class="w"> </span>use_sim_time:<span class="o">=</span><span class="nb">true</span>
</pre></div>
</div>
<p>The use_sim_time:=true parameter ensures proper synchronization with the simulation clock.  Cartographer will begin building a map as you move the robot. The initial map will look like this:</p>
<a class="reference internal image-reference" href="../_images/Proj1_CartographerInit.png"><img alt="../_images/Proj1_CartographerInit.png" class="align-center" src="../_images/Proj1_CartographerInit.png" style="width: 400px;" /></a>
</li>
<li><p>Use a gamepad to manually control the robot and navigate the maze. Run the following command to start the gamepad controller:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>launch<span class="w"> </span>lab4_gamepad<span class="w"> </span>gamepad.launch.py
</pre></div>
</div>
<ul class="simple">
<li><p>Black pixels represent obstacles (walls).</p></li>
<li><p>Gray pixels indicate noise or uncertainty. As you complete multiple laps, the uncertainty decreases, and light gray pixels become darker.</p></li>
</ul>
<p>Once the map is complete, it should look like this:</p>
<a class="reference internal image-reference" href="../_images/Proj1_CartographerDone.png"><img alt="../_images/Proj1_CartographerDone.png" class="align-center" src="../_images/Proj1_CartographerDone.png" style="width: 400px;" /></a>
</li>
<li><p>After mapping the maze, save the map using the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>run<span class="w"> </span>nav2_map_server<span class="w"> </span>map_saver_cli<span class="w"> </span>-f<span class="w"> </span>~/map
</pre></div>
</div>
</li>
<li><p>Confirm that two files, <code class="docutils literal notranslate"><span class="pre">map.yaml</span></code> and <code class="docutils literal notranslate"><span class="pre">map.pgm</span></code>, have been created in your home directory. Then view the contents of <code class="docutils literal notranslate"><span class="pre">map.yaml</span></code> using the <code class="docutils literal notranslate"><span class="pre">cat</span></code> command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cat<span class="w"> </span>map.yaml
</pre></div>
</div>
<p>Example output:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>image:<span class="w"> </span>map.pgm
mode:<span class="w"> </span>trinary
resolution:<span class="w"> </span><span class="m">0</span>.05
origin:<span class="w"> </span><span class="o">[</span>-0.5,<span class="w"> </span>-0.7,<span class="w"> </span><span class="m">0</span><span class="o">]</span>
negate:<span class="w"> </span><span class="m">0</span>
occupied_thresh:<span class="w"> </span><span class="m">0</span>.65
free_thresh:<span class="w"> </span><span class="m">0</span>.25
</pre></div>
</div>
<ul class="simple">
<li><p>resolution: Each pixel represents 0.05 m x 0.05 m in the real world.</p></li>
<li><p>origin:  [-0.5, -0.7, 0] means the map starts at (-0.5 m, -0.7 m, 0 m) in the world frame</p></li>
<li><p>occupied_thresh: The occupancy grid values greater than 65 are considered ‚Äúoccupied‚Äù</p></li>
<li><p>free_thresh: The occupancy grid values less than 25 are considered ‚Äúfree space‚Äù</p></li>
</ul>
</li>
<li><p>Download <a class="reference download internal" download="" href="../_downloads/a32d27a1097ea56816ba5a546338e9d9/map_plotter.py"><span class="xref download myst"><code class="docutils literal notranslate"><span class="pre">map_plotter.py</span></code></span></a> to your home directory. Then, make the script executable:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>chmod<span class="w"> </span>+x<span class="w"> </span>map_plotter.py
</pre></div>
</div>
</li>
<li><p>Verify the file permissions using <code class="docutils literal notranslate"><span class="pre">ls</span> <span class="pre">-l</span></code>.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>If asked about the command to make a file executable only for the owner, you should know the answer for your GR. üòâ</p>
</div>
</li>
<li><p>Complete the <code class="docutils literal notranslate"><span class="pre">TODO</span></code> section in <code class="docutils literal notranslate"><span class="pre">map_plotter.py</span></code>, and then run the script to generate the map.</p></li>
<li><p>Run the script to plot the map:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./map_plotter.py
</pre></div>
</div>
</li>
<li><p>Verify that the map dimensions match the actual maze. Each wall piece is <strong>0.18 meters</strong> long.</p></li>
</ol>
</section>
<section id="navigation-with-slam">
<h3><strong>2. Navigation with SLAM</strong><a class="headerlink" href="#navigation-with-slam" title="Link to this heading">#</a></h3>
<p>Now, let‚Äôs set up <strong>autonomous SLAM</strong> using <strong>Cartographer</strong> and <strong>Navigation2</strong> to navigate the environment dynamically.</p>
<ol class="arabic">
<li><p>Start the TurtleBot3 simulation in the Gazebo world:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>launch<span class="w"> </span>turtlebot3_gazebo<span class="w"> </span>turtlebot3_world.launch.py
</pre></div>
</div>
<p>The Gazebo environment will look like this:</p>
<a class="reference internal image-reference" href="../_images/Lab9_GazeboWorld.png"><img alt="../_images/Lab9_GazeboWorld.png" class="align-center" src="../_images/Lab9_GazeboWorld.png" style="width: 400px;" /></a>
</li>
<li><p>Run Cartographer to begin building the map in real-time:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>launch<span class="w"> </span>turtlebot3_cartographer<span class="w"> </span>cartographer.launch.py<span class="w"> </span>use_sim_time:<span class="o">=</span><span class="nb">true</span>
</pre></div>
</div>
<p>The initial map will appear as shown below:</p>
<a class="reference internal image-reference" href="../_images/Lab9_CartographerInit.png"><img alt="../_images/Lab9_CartographerInit.png" class="align-center" src="../_images/Lab9_CartographerInit.png" style="width: 400px;" /></a>
</li>
<li><p>Run Navigation2 alongside Cartographer to allow the robot to navigate autonomously:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>launch<span class="w"> </span>turtlebot3_navigation2<span class="w"> </span>navigation2.launch.py<span class="w"> </span>use_sim_time:<span class="o">=</span><span class="nb">true</span>
</pre></div>
</div>
<p>The RViz2 interface will look like this:</p>
<a class="reference internal image-reference" href="../_images/Lab9_Nav2WorldInit.png"><img alt="../_images/Lab9_Nav2WorldInit.png" class="align-center" src="../_images/Lab9_Nav2WorldInit.png" style="width: 400px;" /></a>
</li>
<li><p>You can show or hide the <code class="docutils literal notranslate"><span class="pre">Global</span> <span class="pre">Costmap</span></code> and <code class="docutils literal notranslate"><span class="pre">Local</span> <span class="pre">Costmap</span></code> on RViz2 using the checkboxes on the  the <code class="docutils literal notranslate"><span class="pre">Display</span></code> sidebar:</p>
<a class="reference internal image-reference" href="../_images/Lab9_Nav2CostMap.png"><img alt="../_images/Lab9_Nav2CostMap.png" class="align-center" src="../_images/Lab9_Nav2CostMap.png" style="width: 400px;" /></a>
</li>
<li><p>Use the <strong>2D Pose Estimate</strong> tool in RViz2 to set the robot‚Äôs initial position:</p>
<ul class="simple">
<li><p>Click on the map where the robot is located.</p></li>
<li><p>Drag the green arrow to match the robot‚Äôs orientation.</p></li>
</ul>
</li>
<li><p>Use the <strong>2D Nav Goal</strong> tool to set navigation targets. The robot will autonomously explore the maze, updating the map dynamically as it moves.</p>
<p>As the robot explores, the map will evolve, as shown below:</p>
<a class="reference internal image-reference" href="../_images/Lab9_Nav2WorldInProgress.png"><img alt="../_images/Lab9_Nav2WorldInProgress.png" class="align-center" src="../_images/Lab9_Nav2WorldInProgress.png" style="width: 400px;" /></a>
<p>The Gazebo simulation will reflect the robot‚Äôs progress:</p>
<a class="reference internal image-reference" href="../_images/Lab9_GazeboWorldInProgress.png"><img alt="../_images/Lab9_GazeboWorldInProgress.png" class="align-center" src="../_images/Lab9_GazeboWorldInProgress.png" style="width: 400px;" /></a>
</li>
<li><p>Explore the entire world and create a map. Ensure you have dark gray obstacles.</p></li>
<li><p>Take a screenshot of the cartographer window by right clicking the title bar.  Submit the screenshot on Gradescope.</p></li>
</ol>
</section>
<section id="autonomous-navigation-with-slam-in-gazebo">
<h3><strong>3. Autonomous Navigation with SLAM in Gazebo</strong><a class="headerlink" href="#autonomous-navigation-with-slam-in-gazebo" title="Link to this heading">#</a></h3>
<ol class="arabic">
<li><p>Create a package named <code class="docutils literal notranslate"><span class="pre">lab9_slam</span></code> with the <code class="docutils literal notranslate"><span class="pre">BSD-3-Clause</span></code> license and dependencies:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">rclpy</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">geometry_msgs</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nav2_msgs</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">action_msgs</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">numpy</span></code></p></li>
</ul>
<p><em>Hint: There‚Äôs a way to include all dependencies at the time of package creation.</em></p>
</li>
<li><p>Download the <a class="reference download internal" download="" href="../_downloads/2b090c38a95ca90d5d5de845f41f783d/navigate_maze.py"><span class="xref download myst"><code class="docutils literal notranslate"><span class="pre">navigate_maze.py</span></code></span></a> script and save it in the appropriate folder within your package (You should know where this file should go by now).</p></li>
<li><p>Update the <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> file by correctly adding the entry point for <code class="docutils literal notranslate"><span class="pre">navigate_maze.py</span></code>. This is necessary to ensure that the script runs as a node.</p></li>
<li><p>Open the <code class="docutils literal notranslate"><span class="pre">navigate_maze.py</span></code> script and fill in the <code class="docutils literal notranslate"><span class="pre">TODO</span></code> sections. Pay attention to:</p>
<ul class="simple">
<li><p>Setting the target pose for the robot.</p></li>
<li><p>Utilizing the Nav2 action server/client.</p></li>
</ul>
</li>
<li><p>Ensure you build the package correctly to make the script executable.</p></li>
<li><p>Start the TurtleBot3 simulation in Gazebo.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>launch<span class="w"> </span>turtlebot3_gazebo<span class="w"> </span>maze.launch.py
</pre></div>
</div>
</li>
<li><p>Launch Cartographer to enable SLAM</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>launch<span class="w"> </span>turtlebot3_cartographer<span class="w"> </span>cartographer.launch.py<span class="w"> </span>use_sim_time:<span class="o">=</span><span class="nb">true</span>
</pre></div>
</div>
</li>
<li><p>Start Navigation2 for path planning and exploration.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>launch<span class="w"> </span>turtlebot3_navigation2<span class="w"> </span>navigation2.launch.py<span class="w"> </span>use_sim_time:<span class="o">=</span><span class="nb">true</span>
</pre></div>
</div>
</li>
<li><p>Finally, run the <code class="docutils literal notranslate"><span class="pre">navigate_maze.py</span></code> script to let the robot autonomously navigate the maze, building and updating a dynamic map.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>run<span class="w"> </span>lab9_slam<span class="w"> </span>navigate
</pre></div>
</div>
<p>You may observe it take some time for the robot to get the correct orientation at a corner.</p>
<p>The output should be something similar to</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">1742273732</span>.645040148<span class="o">]</span><span class="w"> </span><span class="o">[</span>maze_navigator<span class="o">]</span>:<span class="w"> </span>Initial<span class="w"> </span>pose<span class="w"> </span>published
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">1742273733</span>.398096942<span class="o">]</span><span class="w"> </span><span class="o">[</span>maze_navigator<span class="o">]</span>:<span class="w"> </span>Nav2<span class="w"> </span>server<span class="w"> </span>available,<span class="w"> </span>starting<span class="w"> </span>navigation...
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">1742273733</span>.399054077<span class="o">]</span><span class="w"> </span><span class="o">[</span>maze_navigator<span class="o">]</span>:<span class="w"> </span>Sending<span class="w"> </span>goal<span class="w"> </span><span class="m">1</span>:<span class="w"> </span><span class="o">(</span><span class="m">0</span>.5,<span class="w"> </span><span class="m">0</span>.0<span class="o">)</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">1742273733</span>.401044101<span class="o">]</span><span class="w"> </span><span class="o">[</span>maze_navigator<span class="o">]</span>:<span class="w"> </span>Goal<span class="w"> </span>accepted,<span class="w"> </span>waiting<span class="w"> </span><span class="k">for</span><span class="w"> </span>result...
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">1742273737</span>.764679146<span class="o">]</span><span class="w"> </span><span class="o">[</span>maze_navigator<span class="o">]</span>:<span class="w"> </span>Goal<span class="w"> </span><span class="m">1</span><span class="w"> </span>reached!
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">1742273738</span>.766196490<span class="o">]</span><span class="w"> </span><span class="o">[</span>maze_navigator<span class="o">]</span>:<span class="w"> </span>Sending<span class="w"> </span>goal<span class="w"> </span><span class="m">2</span>:<span class="w"> </span><span class="o">(</span><span class="m">2</span>.34,<span class="w"> </span><span class="m">0</span>.0<span class="o">)</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">1742273738</span>.767399121<span class="o">]</span><span class="w"> </span><span class="o">[</span>maze_navigator<span class="o">]</span>:<span class="w"> </span>Goal<span class="w"> </span>accepted,<span class="w"> </span>waiting<span class="w"> </span><span class="k">for</span><span class="w"> </span>result...
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">1742273760</span>.849179777<span class="o">]</span><span class="w"> </span><span class="o">[</span>maze_navigator<span class="o">]</span>:<span class="w"> </span>Goal<span class="w"> </span><span class="m">2</span><span class="w"> </span>reached!
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">1742273761</span>.851515638<span class="o">]</span><span class="w"> </span><span class="o">[</span>maze_navigator<span class="o">]</span>:<span class="w"> </span>Sending<span class="w"> </span>goal<span class="w"> </span><span class="m">3</span>:<span class="w"> </span><span class="o">(</span><span class="m">2</span>.34,<span class="w"> </span><span class="m">1</span>.26<span class="o">)</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">1742273761</span>.853327625<span class="o">]</span><span class="w"> </span><span class="o">[</span>maze_navigator<span class="o">]</span>:<span class="w"> </span>Goal<span class="w"> </span>accepted,<span class="w"> </span>waiting<span class="w"> </span><span class="k">for</span><span class="w"> </span>result...
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">1742273771</span>.914192259<span class="o">]</span><span class="w"> </span><span class="o">[</span>maze_navigator<span class="o">]</span>:<span class="w"> </span>Goal<span class="w"> </span><span class="m">3</span><span class="w"> </span>reached!
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">1742273772</span>.916137851<span class="o">]</span><span class="w"> </span><span class="o">[</span>maze_navigator<span class="o">]</span>:<span class="w"> </span>Sending<span class="w"> </span>goal<span class="w"> </span><span class="m">4</span>:<span class="w"> </span><span class="o">(</span><span class="m">1</span>.8,<span class="w"> </span><span class="m">1</span>.26<span class="o">)</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">1742273772</span>.918236311<span class="o">]</span><span class="w"> </span><span class="o">[</span>maze_navigator<span class="o">]</span>:<span class="w"> </span>Goal<span class="w"> </span>accepted,<span class="w"> </span>waiting<span class="w"> </span><span class="k">for</span><span class="w"> </span>result...
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">1742273775</span>.779635353<span class="o">]</span><span class="w"> </span><span class="o">[</span>maze_navigator<span class="o">]</span>:<span class="w"> </span>Goal<span class="w"> </span><span class="m">4</span><span class="w"> </span>reached!
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">1742273776</span>.780995770<span class="o">]</span><span class="w"> </span><span class="o">[</span>maze_navigator<span class="o">]</span>:<span class="w"> </span>Sending<span class="w"> </span>goal<span class="w"> </span><span class="m">5</span>:<span class="w"> </span><span class="o">(</span><span class="m">1</span>.8,<span class="w"> </span><span class="m">0</span>.54<span class="o">)</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">1742273776</span>.783869671<span class="o">]</span><span class="w"> </span><span class="o">[</span>maze_navigator<span class="o">]</span>:<span class="w"> </span>Goal<span class="w"> </span>accepted,<span class="w"> </span>waiting<span class="w"> </span><span class="k">for</span><span class="w"> </span>result...
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">1742273796</span>.064376706<span class="o">]</span><span class="w"> </span><span class="o">[</span>maze_navigator<span class="o">]</span>:<span class="w"> </span>Goal<span class="w"> </span><span class="m">5</span><span class="w"> </span>reached!
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">1742273797</span>.066189894<span class="o">]</span><span class="w"> </span><span class="o">[</span>maze_navigator<span class="o">]</span>:<span class="w"> </span>Sending<span class="w"> </span>goal<span class="w"> </span><span class="m">6</span>:<span class="w"> </span><span class="o">(</span><span class="m">0</span>.0,<span class="w"> </span><span class="m">0</span>.54<span class="o">)</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">1742273797</span>.068158332<span class="o">]</span><span class="w"> </span><span class="o">[</span>maze_navigator<span class="o">]</span>:<span class="w"> </span>Goal<span class="w"> </span>accepted,<span class="w"> </span>waiting<span class="w"> </span><span class="k">for</span><span class="w"> </span>result...
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">1742273807</span>.929930815<span class="o">]</span><span class="w"> </span><span class="o">[</span>maze_navigator<span class="o">]</span>:<span class="w"> </span>Goal<span class="w"> </span><span class="m">6</span><span class="w"> </span>reached!
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">1742273808</span>.931021374<span class="o">]</span><span class="w"> </span><span class="o">[</span>maze_navigator<span class="o">]</span>:<span class="w"> </span>Sending<span class="w"> </span>goal<span class="w"> </span><span class="m">7</span>:<span class="w"> </span><span class="o">(</span><span class="m">0</span>.0,<span class="w"> </span><span class="m">0</span>.0<span class="o">)</span>
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">1742273808</span>.933491318<span class="o">]</span><span class="w"> </span><span class="o">[</span>maze_navigator<span class="o">]</span>:<span class="w"> </span>Goal<span class="w"> </span>accepted,<span class="w"> </span>waiting<span class="w"> </span><span class="k">for</span><span class="w"> </span>result...
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">1742273816</span>.294277081<span class="o">]</span><span class="w"> </span><span class="o">[</span>maze_navigator<span class="o">]</span>:<span class="w"> </span>Goal<span class="w"> </span><span class="m">7</span><span class="w"> </span>reached!
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">1742273817</span>.295986020<span class="o">]</span><span class="w"> </span><span class="o">[</span>maze_navigator<span class="o">]</span>:<span class="w"> </span>Completed<span class="w"> </span>navigating<span class="w"> </span>the<span class="w"> </span>maze!
</pre></div>
</div>
</li>
</ol>
</section>
<section id="autonomous-navigation-with-prebuilt-map-in-gazebo">
<h3><strong>4. Autonomous Navigation with Prebuilt Map in Gazebo</strong><a class="headerlink" href="#autonomous-navigation-with-prebuilt-map-in-gazebo" title="Link to this heading">#</a></h3>
<p>Follow these steps to simulate autonomous navigation with <strong>prebuilt map</strong> in the Gazebo environment.</p>
<ol class="arabic">
<li><p>Launch the TurtleBot3 simulation in Gazebo.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>launch<span class="w"> </span>turtlebot3_gazebo<span class="w"> </span>maze.launch.py
</pre></div>
</div>
</li>
<li><p>For this part of the lab, we are working with a prebuilt map. Cartographer, which is used for real-time map creation, is not required here.</p></li>
<li><p>Run</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>run<span class="w"> </span>tf2_ros<span class="w"> </span>tf2_echo1<span class="w"> </span>map<span class="w"> </span>odom
</pre></div>
</div>
<p>This command listens for the transform between the map frame and the odom frame and continuously prints the transformation (translation and rotation). It helps verify if the transform exists and provides real-time values. It will print something similar to</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>At<span class="w"> </span><span class="nb">time</span><span class="w"> </span><span class="m">132</span>.100000000
-<span class="w"> </span>Translation:<span class="w"> </span><span class="o">[</span>-0.227,<span class="w"> </span>-0.274,<span class="w"> </span>-0.088<span class="o">]</span>
-<span class="w"> </span>Rotation:<span class="w"> </span><span class="k">in</span><span class="w"> </span>Quaternion<span class="w"> </span><span class="o">[</span>-0.000,<span class="w"> </span>-0.003,<span class="w"> </span><span class="m">0</span>.001,<span class="w"> </span><span class="m">1</span>.000<span class="o">]</span>
-<span class="w"> </span>Rotation:<span class="w"> </span><span class="k">in</span><span class="w"> </span>RPY<span class="w"> </span><span class="o">(</span>radian<span class="o">)</span><span class="w"> </span><span class="o">[</span>-0.000,<span class="w"> </span>-0.006,<span class="w"> </span><span class="m">0</span>.002<span class="o">]</span>
-<span class="w"> </span>Rotation:<span class="w"> </span><span class="k">in</span><span class="w"> </span>RPY<span class="w"> </span><span class="o">(</span>degree<span class="o">)</span><span class="w"> </span><span class="o">[</span>-0.006,<span class="w"> </span>-0.328,<span class="w"> </span><span class="m">0</span>.131<span class="o">]</span>
</pre></div>
</div>
<p>It means</p>
<ul class="simple">
<li><p>The map to odom transform was eventually found.</p></li>
<li><p>The robot‚Äôs odometry (odom) is offset from map by:</p>
<ul>
<li><p>Position: (-0.227, -0.274, -0.088)</p></li>
<li><p>Orientation (rotation as quaternion &amp; RPY)
So, the map and odom frames are not identical and need a static transformation to be set correctly.</p></li>
</ul>
</li>
</ul>
</li>
<li><p>Publish a Static Transform Between Frames:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>ros2<span class="w"> </span>run<span class="w"> </span>tf2_ros<span class="w"> </span>static_transform_publisher<span class="w"> </span>-0.227<span class="w"> </span>-0.274<span class="w"> </span>-0.088<span class="w"> </span><span class="m">0</span>.0<span class="w"> </span><span class="m">0</span>.0<span class="w"> </span><span class="m">0</span>.0<span class="w"> </span>map<span class="w"> </span>odom
</pre></div>
</div>
<p>This command establishes a static relationship between the <code class="docutils literal notranslate"><span class="pre">map</span></code> and <code class="docutils literal notranslate"><span class="pre">odom</span></code> frames, assuming they are aligned without any offset. It‚Äôs a prerequisite for linking the global (map) frame to the local (odom) frame in a robot‚Äôs TF (Transform) tree. We set the orientation offset to zeros because they are techinicall all zeros.</p>
</li>
<li><p>Start the AMCL (Adaptive Monte Carlo Localization) node to localize the robot within the prebuilt map (map.yaml).</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>run<span class="w"> </span>nav2_amcl<span class="w"> </span>amcl<span class="w"> </span>--ros-args<span class="w"> </span>-p<span class="w"> </span>use_sim_time:<span class="o">=</span><span class="nb">true</span><span class="w"> </span>-p<span class="w"> </span>yaml_filename:<span class="o">=</span><span class="nv">$HOME</span>/map.yaml
</pre></div>
</div>
</li>
<li><p>Start the Navigation2 stack with the prebuilt map (<code class="docutils literal notranslate"><span class="pre">map.yaml</span></code>). Confirm that the robot can load and utilize the map effectively.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>launch<span class="w"> </span>turtlebot3_navigation2<span class="w"> </span>navigation2.launch.py<span class="w"> </span>use_sim_time:<span class="o">=</span><span class="nb">true</span><span class="w"> </span>map:<span class="o">=</span><span class="nv">$HOME</span>/map.yaml<span class="w"> </span>
</pre></div>
</div>
<p>You should be able to find the prebuilt map.</p>
</li>
<li><p>Run the SLAM exploration node:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>run<span class="w"> </span>lab9_slam<span class="w"> </span>navigate
</pre></div>
</div>
</li>
<li><p><strong>Reflect on Differences</strong>: Compare the robot‚Äôs performance with a prebuilt map to its performance when generating a map in real-time. Note any improvements or challenges.</p></li>
</ol>
</section>
<section id="optional-autonomous-navigation-with-cartographer-turtlebot3-real-environment">
<h3><strong>5. (Optional) Autonomous Navigation with Cartographer (TurtleBot3, Real Environment)</strong><a class="headerlink" href="#optional-autonomous-navigation-with-cartographer-turtlebot3-real-environment" title="Link to this heading">#</a></h3>
<ol class="arabic">
<li><p>First, you need to ensure that the data and time on the robot match those on the master computer.</p>
<ul>
<li><p>Log on to the raspberry pi using SSH, and run</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>date<span class="w">    </span>
</pre></div>
</div>
<p>Run the same command on the master. If they do not match, run the following command on the master:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;your_password&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>ssh<span class="w"> </span>pi@192.168.4.1<span class="w"> </span><span class="s2">&quot;echo &#39;your_password&#39; | sudo -S date -s \&quot;</span><span class="k">$(</span>date<span class="w"> </span><span class="s1">&#39;+%Y-%m-%d %H:%M:%S&#39;</span><span class="k">)</span><span class="s2">\&quot;&quot;</span>
</pre></div>
</div>
<p>Ensure that ‚Äòyour_password‚Äô should be replaced with your actual password.</p>
</li>
<li><p>In case you have an error similar to</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo:<span class="w"> </span>unable<span class="w"> </span>to<span class="w"> </span>resolve<span class="w"> </span>host<span class="w"> </span>robot99:<span class="w"> </span>Temporary<span class="w"> </span>failure<span class="w"> </span><span class="k">in</span><span class="w"> </span>name<span class="w"> </span>resolution
</pre></div>
</div>
<p>Log on to the robot, and run</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>nano<span class="w"> </span>/etc/hosts
</pre></div>
</div>
<p>Then, add the following line</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="m">127</span>.0.0.1<span class="w">   </span>robotX<span class="w">        </span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">X</span></code> is your robot number.</p>
</li>
<li><p>Run the <code class="docutils literal notranslate"><span class="pre">date</span></code> command on the robot to verify that they match. Make sure the time zone also matches. If the robot‚Äôs time zone is not MDT, change it by using</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>timedatectl<span class="w"> </span>set-timezone<span class="w"> </span>America/Denver
</pre></div>
</div>
</li>
</ul>
</li>
<li><p>Start the <code class="docutils literal notranslate"><span class="pre">bringup</span></code> process to initialize the robot in a real environment.</p></li>
<li><p>Launch Cartographer to perform SLAM in real time and create a map.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>launch<span class="w"> </span>turtlebot3_cartographer<span class="w"> </span>cartographer.launch.py
</pre></div>
</div>
<p>Ensure that <code class="docutils literal notranslate"><span class="pre">base-link</span></code>, <code class="docutils literal notranslate"><span class="pre">odom</span></code>, and <code class="docutils literal notranslate"><span class="pre">map</span></code> frames are displayed on the map. You also need to check there is no error or warnong on <code class="docutils literal notranslate"><span class="pre">TF</span></code> on the <code class="docutils literal notranslate"><span class="pre">Display</span></code> sidebar.</p>
</li>
<li><p>Start the Navigation2 stack to enable autonomous exploration and navigation.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>launch<span class="w"> </span>turtlebot3_navigation2<span class="w"> </span>navigation2.launch.py
</pre></div>
</div>
</li>
<li><p>Execute the SLAM exploration node and observe the robot autonomously navigate its surroundings while dynamically updating its map.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>run<span class="w"> </span>lab9_slam<span class="w"> </span>navigate
</pre></div>
</div>
</li>
</ol>
</section>
<section id="optional-autonomous-navigation-with-prebuilt-map-turtlebot3-real-environment">
<h3><strong>6. (Optional) Autonomous Navigation with Prebuilt Map (TurtleBot3, Real Environment)</strong><a class="headerlink" href="#optional-autonomous-navigation-with-prebuilt-map-turtlebot3-real-environment" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>Start the <code class="docutils literal notranslate"><span class="pre">bringup</span></code> process for the real TurtleBot3 environment.</p></li>
<li><p>Use AMCL and the prebuilt map for localization. Ensure you set a static transform between <code class="docutils literal notranslate"><span class="pre">map</span></code> and <code class="docutils literal notranslate"><span class="pre">odom</span></code>.</p></li>
<li><p>Start the Navigation2 stack with the prebuilt map, ensuring the robot can locate itself within the map.</p></li>
<li><p>Execute the SLAM exploration node. Observe and evaluate how the robot navigates with a prebuilt map.</p></li>
<li><p><strong>Analyze Performance</strong></p>
<ul class="simple">
<li><p>Discuss and note differences in navigation performance between using a real-time generated map and a prebuilt map.</p></li>
</ul>
</li>
</ol>
</section>
</section>
<section id="deliverables">
<h2>üöö Deliverables<a class="headerlink" href="#deliverables" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><strong>[10 Points] Complete the <code class="docutils literal notranslate"><span class="pre">map_plotter.py</span></code> Script</strong></p>
<ul class="simple">
<li><p>Ensure the script is fully functional and implements all required features.</p></li>
<li><p>Push your code to GitHub and confirm that it has been successfully uploaded.
<strong>NOTE:</strong> <em>If the instructor can‚Äôt find your code in your repository, you will receive a grade of 0 for the coding part.</em></p></li>
</ul>
</li>
<li><p><strong>[10 Points] Complete the <code class="docutils literal notranslate"><span class="pre">navigate_maze.py</span></code> Script</strong></p>
<ul class="simple">
<li><p>Ensure the script is fully functional and implements all required features.</p></li>
<li><p>Push your code to GitHub and confirm that it has been successfully uploaded.
<strong>NOTE:</strong> <em>If the instructor can‚Äôt find your code in your repository, you will receive a grade of 0 for the coding part.</em></p></li>
</ul>
</li>
<li><p><strong>[10 Points] Submit Screenshots</strong></p>
<ul class="simple">
<li><p>Submit the two screenshots on Gradescope</p></li>
</ul>
</li>
<li><p><strong>[10 Points] Demonstration</strong></p>
<ul class="simple">
<li><p>Show the robot successfully move between two walls in the simulation environment.</p></li>
</ul>
</li>
<li><p><strong>[10 Points] Reflection and Analysis</strong></p>
<ul class="simple">
<li><p>Provide your reflection and analysis on Gradescope</p></li>
</ul>
</li>
</ol>
<!--
To determine the origins of the `map` and `odom` frames with respect to the world frame, you'll need to analyze the relationships in your robot's **TF (Transform) tree**. Here‚Äôs how you can do it:

---

### 1. **Visualize the TF Tree**
Use the TF visualization tools to observe the transform hierarchy:
   - Run the following in a terminal to visualize the TF tree:
     ```bash
     ros2 run tf2_tools view_frames
     ```
     This will generate a PDF (`frames.pdf`) showing the entire TF tree, including the origins of frames like `map` and `odom`.

   - Alternatively, in RViz2, add the **TF display** plugin to view the transform frames in real time and see how `map` and `odom` are positioned relative to each other and other frames.

---

### 2. **Query Specific Transforms**
To find the exact transform between `map` and `odom` (or any other frames), use the `tf2_echo` command:
   ```bash
   ros2 run tf2_ros tf2_echo map odom
   ```
   This will display the translation (x, y, z) and rotation (quaternion) values of the `odom` frame relative to the `map` frame. If you're looking for the relationship with a world frame, replace `map` or `odom` with the name of your world frame.

   - **Translation:** Gives you the position of the origin (in meters).
   - **Rotation:** Indicates orientation as a quaternion, which you can convert to roll, pitch, and yaw if needed.

---

### 3. **Check Static Transforms**
If static transforms are being used (like in your earlier command), the transformation values might already be predefined. You can inspect the parameters or commands to see the exact translation and rotation settings used when broadcasting those frames.

---

### 4. **Understand Frame Association**
- In most robot setups, the `map` frame is typically aligned with the global reference frame, representing a fixed coordinate system for localization.
- The `odom` frame, on the other hand, is aligned with the odometry system, which can drift over time. The transform between `map` and `odom` is often determined by the robot's localization system (e.g., AMCL, SLAM).

---

Let me know if you'd like guidance on any of these steps! I can also assist with debugging transforms or interpreting the output from `tf2_echo`.
-->
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Labs"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Lab8_LIDAR.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">üî¨ Lab 8: LiDAR</p>
      </div>
    </a>
    <a class="right-next"
       href="Lab10_CV.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">üî¨ Lab10: CV</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#objectives">üìå Objectives</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">üìú Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pre-lab-ros2-client-libraries">üå± Pre-Lab: ROS2 Client Libraries</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lab-procedures">üõ†Ô∏è Lab Procedures</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-up-turtlebot3-with-slam-in-gazebo"><strong>1. Setting Up TurtleBot3 with SLAM in Gazebo</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#navigation-with-slam"><strong>2. Navigation with SLAM</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#autonomous-navigation-with-slam-in-gazebo"><strong>3. Autonomous Navigation with SLAM in Gazebo</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#autonomous-navigation-with-prebuilt-map-in-gazebo"><strong>4. Autonomous Navigation with Prebuilt Map in Gazebo</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#optional-autonomous-navigation-with-cartographer-turtlebot3-real-environment"><strong>5. (Optional) Autonomous Navigation with Cartographer (TurtleBot3, Real Environment)</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#optional-autonomous-navigation-with-prebuilt-map-turtlebot3-real-environment"><strong>6. (Optional) Autonomous Navigation with Prebuilt Map (TurtleBot3, Real Environment)</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deliverables">üöö Deliverables</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Stan Baek
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>